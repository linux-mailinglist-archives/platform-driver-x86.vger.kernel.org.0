Return-Path: <platform-driver-x86-owner@vger.kernel.org>
X-Original-To: lists+platform-driver-x86@lfdr.de
Delivered-To: lists+platform-driver-x86@lfdr.de
Received: from out1.vger.email (out1.vger.email [IPv6:2620:137:e000::1:20])
	by mail.lfdr.de (Postfix) with ESMTP id 44D6C4F1F50
	for <lists+platform-driver-x86@lfdr.de>; Tue,  5 Apr 2022 00:46:58 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S229522AbiDDWrg (ORCPT
        <rfc822;lists+platform-driver-x86@lfdr.de>);
        Mon, 4 Apr 2022 18:47:36 -0400
Received: from lindbergh.monkeyblade.net ([23.128.96.19]:60096 "EHLO
        lindbergh.monkeyblade.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S237904AbiDDWrP (ORCPT
        <rfc822;platform-driver-x86@vger.kernel.org>);
        Mon, 4 Apr 2022 18:47:15 -0400
Received: from NAM11-DM6-obe.outbound.protection.outlook.com (mail-dm6nam11on2064.outbound.protection.outlook.com [40.107.223.64])
        by lindbergh.monkeyblade.net (Postfix) with ESMTPS id 79BBAE023
        for <platform-driver-x86@vger.kernel.org>; Mon,  4 Apr 2022 14:59:28 -0700 (PDT)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=hCfuEKH2KW56UXrkiVMy7yRo1C6BGNOXPS5fqXTjpObgY+YrQV0LwS9h7bistfEXNQWpeQ/asnBMtLN2A35GW2q+9mpkoTKRgJzJgNVp2EhUWoDB4EVvZZOuxnRhcI2w/jm6EFGblBg7Jf/yjqEHcMT8LdAnXN+cESrGIucY2v+U3rSxT/Q8B2mfrzJ7cQ8umF/Lib3UydvzVg3iTAtXzWMTivwO8QMPSvNWGIpG77fz5FMh3uappXmGuSSz08MozIUHQaBEAEGoWmE0iOgIP8UuoK7LHJ3IeMD4JDynJnH8cIPo77ZdeYWN/ulZ9lOWPJIKQi1RoaD71owEMKkhXw==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-AntiSpam-MessageData-ChunkCount:X-MS-Exchange-AntiSpam-MessageData-0:X-MS-Exchange-AntiSpam-MessageData-1;
 bh=wUJk2ukqswDTbwBapr2Cx9GRaDsrbDIs3qYkPdezA+0=;
 b=aCXtsdJWZW8J94R1y7cbRbRNWl+o7dWVNAPyLYE+y1V+HlIr1ansdO4W/98gfBqbAZ4U+TBA4ywdy6TTOjv6DvhjetfkUUoufaOJjKp12U0ZTgbmbrQYVoR4ODJaPyTEXcSR5nkIlo0gnbHx/KHRclrtVDT9rsBSfZnd+6C5geH4HgV/LL0sQKEF29ZJAQIuyPZ/YX0LYKT1bVOv+5zU1s3F2a8yodRSMi3RgG2WvTeFiqtsdsakrArY1j+cyheZ7oSVx6PVhoSkeXTRAsv2DEGORpHb0T/hu7BkH26v5JuLE7Rbqpjq1mLsIy0WVQmngjLavNNI1xaPlp6eFFggvQ==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=amd.com; dmarc=pass action=none header.from=amd.com; dkim=pass
 header.d=amd.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=amd.com; s=selector1;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=wUJk2ukqswDTbwBapr2Cx9GRaDsrbDIs3qYkPdezA+0=;
 b=ghKqiZFgDLSHFrlkLKrks/ft7YyykRP4hPBisdo5wvnJmDeqWEnw1uroJOWn/TdbJIN3vR3jitEnOnbmRqJwIh8RND3+f/q8EaO3OrxGg7S8be1v19Zm5Sf2NUG/5oQ2tDCIF0wqulAJcuARve1RAeyBoZ/x0ItZqJnJRIO8NLQ=
Received: from BL1PR12MB5157.namprd12.prod.outlook.com (2603:10b6:208:308::15)
 by MN2PR12MB3597.namprd12.prod.outlook.com (2603:10b6:208:cf::25) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.5123.31; Mon, 4 Apr
 2022 21:59:25 +0000
Received: from BL1PR12MB5157.namprd12.prod.outlook.com
 ([fe80::70d6:f6dd:3e14:3c2d]) by BL1PR12MB5157.namprd12.prod.outlook.com
 ([fe80::70d6:f6dd:3e14:3c2d%5]) with mapi id 15.20.5123.031; Mon, 4 Apr 2022
 21:59:25 +0000
From:   "Limonciello, Mario" <Mario.Limonciello@amd.com>
To:     Jorge Lopez <jorgealtxwork@gmail.com>,
        "platform-driver-x86@vger.kernel.org" 
        <platform-driver-x86@vger.kernel.org>
Subject: RE: [PATCH v1 5/6] Sure Admin Security Feature
Thread-Topic: [PATCH v1 5/6] Sure Admin Security Feature
Thread-Index: AQHYSGxup5C3SuFLd0KJnoLPJoyL/KzgTXkA
Date:   Mon, 4 Apr 2022 21:59:25 +0000
Message-ID: <BL1PR12MB5157263F33A534E144618223E2E59@BL1PR12MB5157.namprd12.prod.outlook.com>
References: <20220404203626.4311-1-jorge.lopez2@hp.com>
 <20220404203626.4311-6-jorge.lopez2@hp.com>
In-Reply-To: <20220404203626.4311-6-jorge.lopez2@hp.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
msip_labels: MSIP_Label_d4243a53-6221-4f75-8154-e4b33a5707a1_Enabled=true;
 MSIP_Label_d4243a53-6221-4f75-8154-e4b33a5707a1_SetDate=2022-04-04T21:59:20Z;
 MSIP_Label_d4243a53-6221-4f75-8154-e4b33a5707a1_Method=Privileged;
 MSIP_Label_d4243a53-6221-4f75-8154-e4b33a5707a1_Name=Public-AIP 2.0;
 MSIP_Label_d4243a53-6221-4f75-8154-e4b33a5707a1_SiteId=3dd8961f-e488-4e60-8e11-a82d994e183d;
 MSIP_Label_d4243a53-6221-4f75-8154-e4b33a5707a1_ActionId=8ed654c6-2c2a-4bc5-bac9-892e3fbe3240;
 MSIP_Label_d4243a53-6221-4f75-8154-e4b33a5707a1_ContentBits=1
msip_label_d4243a53-6221-4f75-8154-e4b33a5707a1_enabled: true
msip_label_d4243a53-6221-4f75-8154-e4b33a5707a1_setdate: 2022-04-04T21:59:22Z
msip_label_d4243a53-6221-4f75-8154-e4b33a5707a1_method: Privileged
msip_label_d4243a53-6221-4f75-8154-e4b33a5707a1_name: Public-AIP 2.0
msip_label_d4243a53-6221-4f75-8154-e4b33a5707a1_siteid: 3dd8961f-e488-4e60-8e11-a82d994e183d
msip_label_d4243a53-6221-4f75-8154-e4b33a5707a1_actionid: d70be44e-b9ab-4dea-9a46-da2935749276
msip_label_d4243a53-6221-4f75-8154-e4b33a5707a1_contentbits: 0
authentication-results: dkim=none (message not signed)
 header.d=none;dmarc=none action=none header.from=amd.com;
x-ms-publictraffictype: Email
x-ms-office365-filtering-correlation-id: 40396b45-cbba-4693-fd54-08da1686620b
x-ms-traffictypediagnostic: MN2PR12MB3597:EE_
x-microsoft-antispam-prvs: <MN2PR12MB359730D4244A5308127AED43E2E59@MN2PR12MB3597.namprd12.prod.outlook.com>
x-ms-exchange-senderadcheck: 1
x-ms-exchange-antispam-relay: 0
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: eyMaYy3Vg0c6YDPid2MCTaM3vxt2e+r8wObDdFMvxSplLJiHpC4/g0yr9hO1FnFJp2Ah4NK9ZfIn4iwP/p/GXr5yDXDeLWuRrMrot2wIzKUgK1cZkuNUoSi+cfmXEctLb+p5oba9NboBdRs8q2kGlTvgiOnaBrJLS2o4fhgFqq3EX1T03K+CGD0Ji7Qux8up6Jq7d2WcxRG39ChBwKtzTpLmZexpfCwCJgJb2fTe54ZhXouZjYlX1hiSN8Is397YeAS4BKKj5p2M+TNerDNF9aPA6yW4d0HibkCs6qvN9ProsGlMNQ/aGmIz+ZzEx0iMMrW/WCb3mYQIZwfUNv3gbC/V5j7dXgv+Mwva/l2CbaL9ew13aKWoDskApdFH4jevpB5xGObzV+VGOfk1821VpcTk8Y/b++QdcfbrTt0PpVT58l71Cfmxb0VTWFafMS0XN6/pqa3Uu8UbjB+JBw0lwGfHJlqXVYFpa2UZnKoVTfHBWE4TNKi04rBM42esSPfze4+aXmqoZJnSN9IucnzoIC6SlTPjAk6+ewuP/xjfJaIxflfV8/Sxq0LTTAfFMgSczxy0Md8tCgBSQ6KFDtuCLMKIcm8YYlPr/c5EmEk7mL0aLp39lzBVxoEJI7MtK98Ictmtr9tBChCY4hiYLMhbK7LgMwVLGSLtItUvn/lG336NKtsrInlxoF6Bu1umL/+MBUXd73plEH672kcw/dZ9wcq7yjhgN+kUvaEOEUqnW/groyx6AMjaDV4M5ambaPbwxmSLHRncSz8tj+Bb4ViQPTsVVIjgSybCZ0Qxr0fF4tg=
x-forefront-antispam-report: CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:BL1PR12MB5157.namprd12.prod.outlook.com;PTR:;CAT:NONE;SFS:(13230001)(4636009)(366004)(9686003)(8936002)(52536014)(30864003)(15650500001)(508600001)(71200400001)(86362001)(6506007)(7696005)(5660300002)(33656002)(84970400001)(186003)(110136005)(8676002)(2906002)(83380400001)(316002)(38100700002)(66946007)(55016003)(64756008)(66446008)(66476007)(76116006)(66556008)(53546011)(122000001)(38070700005)(579004)(559001);DIR:OUT;SFP:1101;
x-ms-exchange-antispam-messagedata-chunkcount: 2
x-ms-exchange-antispam-messagedata-0: =?utf-8?B?YkIvb0FFd25WdFNCQ3dra3NqSHpkbW1BT0V4YTk2dmd3TkppYzR4Yml2c09G?=
 =?utf-8?B?UFh2Q2VGWTU0RnBGSkM1RExPc01KQ00xTFpBcHlQKy9WUG84Ym04TkQ4ZE53?=
 =?utf-8?B?bE4rR0dvcnRXWHJFK0F0UzdOa3NJZWdKSlZXYUdob2dNcFVkaGN5YVVrM1BV?=
 =?utf-8?B?YWxwNzlNdWZESkluQnhjMDlKVmF4N0x4VmQxaURYNlZhYXEwZ0J4LzFTdTNU?=
 =?utf-8?B?Z21aL0owSHFaSnhoZnFQSVN4UFB4WEIzYmNZdHNreXh2b3Jac0R3RjhrRTRh?=
 =?utf-8?B?cnhDVjNndis5ZjdPZXk1bEFGR3ErTytkQmlRWi91S2RTM2VOZVl5c3pGY3BO?=
 =?utf-8?B?a2JVSHp0bWM5Nkg3VDdKVFNNTythSGdKVXpMbS9QbDlRNHpXWGtkNGVRVHE1?=
 =?utf-8?B?NElqdlRJUDBwM0ExUDN1R3BpYmZqd0pDWHlsb2FucDh5UGRTSEdzMDN0ZFhL?=
 =?utf-8?B?cXh4c2Zwd2FndlAvQW10eGQ4cUYxaHFYUlRuVUZSVFFaSTBxa0V4b2Y4ZmZv?=
 =?utf-8?B?dzNNTFcyU1JSMkNGSzZ0RGVDSGF5UDR0U3kxKzRtRytFaU51YUcvbUI2amN4?=
 =?utf-8?B?RXpVb2NWTm5sdHNmQ3h1MitZMC9tRVgxeUwvUCtmYnRXRjc3QS81NU1TTmFr?=
 =?utf-8?B?YWExVkdIYldPdHA1ZVcrYXZKQnFtY2Y2OTR0d0k1SzdrdmlibFo3MFRZNU1q?=
 =?utf-8?B?bXNlQ1Axc3Y4S29sTnE5RDQ2L0dTbFFPdU9sSGZsMWFzWVRSZUZuNTI4djNL?=
 =?utf-8?B?YUs2OVFMWUxabmpSejhlbnRVU2xnYXd1M29QNi8wMyt6cXU1dGIyanExaEQ2?=
 =?utf-8?B?cVBWSWVEYzRaWFUzeTVFNytOUXF1RkJPTXdoNXNPN1IwclRXVkplODNsL0Uv?=
 =?utf-8?B?cnlHNEFtUVZrc1lCamwyU3BSNDJqL1VaNGM1dUNzS2V1OStHTm1WYzhtNC95?=
 =?utf-8?B?WTV1dGdKcG9WWjkyeFJydWNzaGNXZHdER2c4ZXhGNFk0MjlGMk1LQ1N2Ny9k?=
 =?utf-8?B?ZHB3YzYwbXJCUUVVYmxaWGJOT2E1TnF5YXd2UytuOHMxbVlMMmY5elpVeHVn?=
 =?utf-8?B?dDRjR3RQc2Q2eHYwRW0yRE5xK1ZWNTBMYmY5SVp1Z29ycnFQYVJrbXZMU0FI?=
 =?utf-8?B?T05obXNBcms4aUIwUCtZNmE5czI0K2k1VmxPVUNhdDN5aWJXS1ZIUUhjOGZ6?=
 =?utf-8?B?ay9yc0RWODV5aUEyY05vVHRQMFJkMlM4U3FJRnp2dUVScGpaUUhpUDVEelNt?=
 =?utf-8?B?Q0NvUjRYS2FFUTRTeFFLQ0lXZjhUMTVXcDBLLzh4UlRBU2t4Q09NQzFXZFZm?=
 =?utf-8?B?d2tieHNvTVMwWHd1QWZtMnBUM0Y0Tm1JemY3WkNmVVNiRlFPRjlKVXpPeVlr?=
 =?utf-8?B?Z2cwUU8zMXdqQ01odzF6NG44NXlvUXFBWkVjNlJ4WW10Qjd2bGdUUXVHa3Jq?=
 =?utf-8?B?SzlQYnVyM29jUzFXY3cwTW1rb25LcURoWWxlWW1vTmFsc2JocElRVXdyTkZY?=
 =?utf-8?B?NkF5V2FxL3NWWGJScEpwOURsNU4xM1NFSXR5ZGVCZmlxRzFDZ0l5SHo3SDZx?=
 =?utf-8?B?dGwwTFVCc21aTkdKNkFCY1A5aWNxMjUxUXo5b21FQ3B1RVlRc3ZGZytFaWJW?=
 =?utf-8?B?Q2VhYTVnbXRjWG5ZVjk3VEFRelFEQnZzUGYwNzVDUWYvcC8vOVlmQ2U0VXN2?=
 =?utf-8?B?MGMweU9sQlRsWEkzcHRSQThHdmtNQWY3eERnRWw4Qk5aV1NhK0k3ZnhGeUgv?=
 =?utf-8?B?K3dQVXpxRDJpaFlJZ3dvRFFrenR2eWNxNWRDMndINm02dWNmZjdzeU5yWGxN?=
 =?utf-8?B?aXExWkxMTmhxTEJCeFNoNDdIeDlJT2FDcDJoZHlpOVVRbnExS29Pclc2ZXl6?=
 =?utf-8?B?Z2lkWHR4ZEVxYkVOSEcxQnEvMUpJYzVJdDBCWnp0ZXdkQ1EzNVR4TWhIUFJm?=
 =?utf-8?B?ajFaWVBWU2ZsVFFvcjFxZ0tPVWlJTnlvTWo5ZlZ1T2crRUNQTCs2dUxJVVdy?=
 =?utf-8?B?YWxWZVBxTEFONlNWRVdVbW9VdlpNcEtyRFQ2T3FyMFkvMGI3UENmTk5NWjlO?=
 =?utf-8?B?ZURSNnRKV0VYRyt3QXl3enEzTDNYMHBWMFZROGhFSjFQY3RqYndoVUJUSnlC?=
 =?utf-8?B?cFZGMmQrcmdYWVgxeHN5S2NPV09OczBlUGkrSXpUSlFZYnppWVZnWUF0eW9D?=
 =?utf-8?B?YTB3SEE1K2xYWUEzTlZ1L3QyeVBaWXhNeTZ5azZNN09TTHlZTTRnbTR1M2ZO?=
 =?utf-8?B?elVYVjJ4d3IwMFhSTTdteGkwK2V5UFdYdmoxS2xWMW54MGZKellxTVBRUXBu?=
 =?utf-8?B?ZVpDRGI4MkoxT3d2b0gyelVPMG12WnFIZ1pDb2ZyaXVKYmhEUnp3Q1RRM0pD?=
 =?utf-8?Q?F/Gf3+kRrv0rH/iqfw7IprSvsK4C+qWyzlFu0fjKuKTbq?=
x-ms-exchange-antispam-messagedata-1: 25HRxmDgsfYwtA==
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: amd.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-AuthSource: BL1PR12MB5157.namprd12.prod.outlook.com
X-MS-Exchange-CrossTenant-Network-Message-Id: 40396b45-cbba-4693-fd54-08da1686620b
X-MS-Exchange-CrossTenant-originalarrivaltime: 04 Apr 2022 21:59:25.0528
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 3dd8961f-e488-4e60-8e11-a82d994e183d
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: u3qT+X7fAxzJ0sFzzQuG+HESeL/qXtaqkqSzNMzU0PzkoiZH1DKwj5SIniL6+hu9FiYC+lwjEjo6EaP5c7FvbQ==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: MN2PR12MB3597
X-Spam-Status: No, score=-2.1 required=5.0 tests=BAYES_00,DKIM_SIGNED,
        DKIM_VALID,DKIM_VALID_AU,DKIM_VALID_EF,RCVD_IN_MSPIKE_H2,SPF_HELO_PASS,
        SPF_PASS,T_SCC_BODY_TEXT_LINE autolearn=ham autolearn_force=no
        version=3.4.6
X-Spam-Checker-Version: SpamAssassin 3.4.6 (2021-04-09) on
        lindbergh.monkeyblade.net
Precedence: bulk
List-ID: <platform-driver-x86.vger.kernel.org>
X-Mailing-List: platform-driver-x86@vger.kernel.org

W1B1YmxpY10NCg0KDQoNCj4gLS0tLS1PcmlnaW5hbCBNZXNzYWdlLS0tLS0NCj4gRnJvbTogSm9y
Z2UgTG9wZXogPGpvcmdlYWx0eHdvcmtAZ21haWwuY29tPg0KPiBTZW50OiBNb25kYXksIEFwcmls
IDQsIDIwMjIgMTU6MzYNCj4gVG86IHBsYXRmb3JtLWRyaXZlci14ODZAdmdlci5rZXJuZWwub3Jn
DQo+IFN1YmplY3Q6IFtQQVRDSCB2MSA1LzZdIFN1cmUgQWRtaW4gU2VjdXJpdHkgRmVhdHVyZQ0K
PiANCj4gSFAgQ29tbWVyY2lhbCBQQ+KAmXMgaGF2ZSBzZXZlcmFsIEJJT1Mgc2V0dGluZ3MgdGhh
dCBjb250cm9sIGl0cw0KPiBiZWhhdmlvdXIgYW5kIGNhcGFiaWxpdGllcywgbWFueSBvZiB3aGlj
aCBhcmUgcmVsYXRlZCB0byBzZWN1cml0eS4gIFRvDQo+IHByZXZlbnQgdW5hdXRob3JpemVkIGNo
YW5nZXMgdG8gdGhlc2Ugc2V0dGluZ3MsIHRoZSBzeXN0ZW0gY2FuIGJlDQo+IGNvbmZpZ3VyZWQg
dG8gdXNlIGEgU3VyZSBBZG1pbiBjcnlwdG9ncmFwaGljIHNpZ25hdHVyZS1iYXNlZA0KPiBhdXRo
b3JpemF0aW9uIHN0cmluZyB0aGF0IHRoZSBCSU9TIHdpbGwgdXNlIHRvIHZlcmlmeSBhdXRob3Jp
emF0aW9uIHRvDQo+IG1vZGlmeSB0aGUgc2V0dGluZy4gQmVoaW5kIHRoZSBzY2VuZXMsIFN1cmUg
QWRtaW4gdXNlcyBTZWN1cmUgUGxhdGZvcm0NCj4gTWFuYWdlbWVudCAoU1BNKSBhbmQgV01JDQo+
IA0KPiAnc2V0dGluZ3MnIGlzIGEgZmlsZSBhc3NvY2lhdGVkIHdpdGggU3VyZSBBZG1pbi4gQklP
UyBzZXR0aW5ncyBjYW4gYmUNCj4gcmVhZCBvciB3cml0dGVuIHRocm91Z2ggdGhlIFN1cmUgQWRt
aW4gc2V0dGluZ3MgZmlsZSBpbiBzeXNmcw0KPiANCj4gCS9zeXMvZGV2aWNlcy9wbGF0Zm9ybS9o
cC13bWkvc3VyZV9hZG1pbi9zZXR0aW5ncw0KPiANCj4gRXhwZWN0ZWQgZGF0YSBmb3JtYXQgdG8g
dXBkYXRlIEJJT1Mgc2V0dGluZw0KPiANCj4gCVtCSU9TIHNldHRpbmddLFtuZXcgdmFsdWVdLFth
dXRoIHRva2VuXQ0KPiANCj4gU2FtcGxlIHNldHRpbmdzIHJlcG9ydGVkIGRhdGENCj4gDQo+IAl7
DQo+IAkJIkNsYXNzIjogIkhQQklPU19CSU9TRW51bWVyYXRpb24iLA0KPiAJCSJOYW1lIjogIlVT
QiBTdG9yYWdlIEJvb3QiLA0KPiAJCSJQYXRoIjogIlxcQWR2YW5jZWRcXEJvb3QgT3B0aW9ucyIs
DQo+IAkJIklzUmVhZE9ubHkiOiAwLA0KPiAJCS4uLg0KPiAJCSJWYWx1ZSI6ICJFbmFibGUiLA0K
PiAJCSJTaXplIjogMiwNCj4gCQkiUG9zc2libGVWYWx1ZXMiOiBbDQo+IAkJCSJEaXNhYmxlIiwN
Cj4gCQkJIkVuYWJsZSINCj4gCQldDQo+IAl9DQo+IA0KDQpUaGlzIHNvdW5kcyBsaWtlIGl0IGhh
cyByZS1pbnZlbnRlZCAvc3lzL2NsYXNzL2Zpcm13YXJlLWF0dHJpYnV0ZXMuDQoNClNob3VsZG4n
dCB5b3UgYWRvcHQgdGhhdCBBUEk/DQoNCj4gVGhpcyBmZWF0dXJlIHJlcXVpcmVzICJVcGRhdGUg
aHBfd21pX2dyb3VwIHRvIHNpbXBsaWZ5IGZlYXR1cmUNCj4gYWRkaXRpb24iIHBhdGNoLg0KPiAN
Cj4gQWxsIGNoYW5nZXMgd2VyZSB2YWxpZGF0ZWQgb24gYSBIUCBaQm9vayBXb3Jrc3RhdGlvbiwN
Cj4gSFAgRWxpdGVCb29rIHgzNjAsIGFuZCBIUCBFbGl0ZUJvb2sgODUwIEc4IG5vdGVib29rcy4N
Cj4gDQo+IFNpZ25lZC1vZmYtYnk6IEpvcmdlIExvcGV6IDxqb3JnZS5sb3BlejJAaHAuY29tPg0K
PiANCj4gLS0tDQo+IEJhc2VkIG9uIHRoZSBsYXRlc3QgcGxhdGZvcm0tZHJpdmVycy14ODYuZ2l0
L2Zvci1uZXh0DQo+IC0tLQ0KPiAgZHJpdmVycy9wbGF0Zm9ybS94ODYvaHAtd21pLmMgfCA5NzcN
Cj4gKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKw0KPiAgMSBmaWxlIGNoYW5nZWQs
IDk3NyBpbnNlcnRpb25zKCspDQo+IA0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9wbGF0Zm9ybS94
ODYvaHAtd21pLmMgYi9kcml2ZXJzL3BsYXRmb3JtL3g4Ni9ocC13bWkuYw0KPiBpbmRleCA5MThl
M2VhZjFiNjcuLmI3MmNhMThiNzdhNiAxMDA2NDQNCj4gLS0tIGEvZHJpdmVycy9wbGF0Zm9ybS94
ODYvaHAtd21pLmMNCj4gKysrIGIvZHJpdmVycy9wbGF0Zm9ybS94ODYvaHAtd21pLmMNCj4gQEAg
LTI3LDYgKzI3LDcgQEANCj4gICNpbmNsdWRlIDxsaW51eC9yZmtpbGwuaD4NCj4gICNpbmNsdWRl
IDxsaW51eC9zdHJpbmcuaD4NCj4gICNpbmNsdWRlIDxsaW51eC9kbWkuaD4NCj4gKyNpbmNsdWRl
IDxsaW51eC9ubHMuaD4NCj4gDQo+ICBNT0RVTEVfQVVUSE9SKCJNYXR0aGV3IEdhcnJldHQgPG1q
ZzU5QHNyY2YudWNhbS5vcmc+Iik7DQo+ICBNT0RVTEVfREVTQ1JJUFRJT04oIkhQIGxhcHRvcCBX
TUkgaG90a2V5cyBkcml2ZXIiKTsNCj4gQEAgLTM3LDggKzM4LDE2IEBAIE1PRFVMRV9BTElBUygi
d21pOjVGQjdGMDM0LTJDNjMtNDVlOS1CRTkxLQ0KPiAzRDQ0RTJDNzA3RTQiKTsNCj4gDQo+ICAj
ZGVmaW5lIEhQV01JX0VWRU5UX0dVSUQgIjk1RjI0Mjc5LTREN0ItNDMzNC05Mzg3LUFDQ0RDNjdF
RjYxQyINCj4gICNkZWZpbmUgSFBXTUlfQklPU19HVUlEICI1RkI3RjAzNC0yQzYzLTQ1ZTktQkU5
MS0zRDQ0RTJDNzA3RTQiDQo+ICsNCj4gICNkZWZpbmUgSFBfT01FTl9FQ19USEVSTUFMX1BST0ZJ
TEVfT0ZGU0VUIDB4OTUNCj4gDQo+ICsjZGVmaW5lIEhQV01JX1NUUklOR19HVUlEICI5ODhEMDhF
My02OEY0LTRjMzUtQUYzRS02QTFCODEwNkY4M0MiDQo+ICsjZGVmaW5lIEhQV01JX0lOVEVHRVJf
R1VJRCAiODIzMkRFM0QtNjYzRC00MzI3LUE4RjQtDQo+IEUyOTNBREI5QkYwNSINCj4gKyNkZWZp
bmUgSFBXTUlfRU5VTUVSQVRJT05fR1VJRCAiMkQxMTRCNDktMkRGQi00MTMwLUI4RkUtDQo+IDRB
M0MwOUU3NTEzMyINCj4gKyNkZWZpbmUgSFBXTUlfT1JERVJFRExJU1RfR1VJRCAiMTRFQTk3NDYt
Q0UxRi00MDk4LUEwRTAtDQo+IDcwNDVDQjREQTc0NSINCj4gKyNkZWZpbmUgSFBXTUlfUEFTU1dP
UkRfR1VJRCAiMzIyRjIwMjgtMEY4NC00OTAxLTk4OEUtDQo+IDAxNTE3NjA0OUUyRCINCj4gKyNk
ZWZpbmUgSFBXTUlfU0VUQklPU1NFVFRJTkdfR1VJRCAiMUY0QzkxRUItREM1Qy00NjBiLTk1MUQt
DQo+IEM3Q0I5QjRCOEQ1RSINCj4gKw0KPiAgLyogRE1JIGJvYXJkIG5hbWVzIG9mIGRldmljZXMg
dGhhdCBzaG91bGQgdXNlIHRoZSBvbWVuIHNwZWNpZmljIHBhdGggZm9yDQo+ICAgKiB0aGVybWFs
IHByb2ZpbGVzLg0KPiAgICogVGhpcyB3YXMgb2J0YWluZWQgYnkgdGFraW5nIGEgbG9vayBpbiB0
aGUgd2luZG93cyBvbWVuIGNvbW1hbmQgY2VudGVyDQo+IEBAIC0xMDI1LDYgKzEwMzQsOTczIEBA
IHN0YXRpYyBjb25zdCBzdHJ1Y3QgYXR0cmlidXRlX2dyb3VwDQo+IHN1cmVfc3RhcnRfZ3JvdXAg
PSB7DQo+ICAJLmF0dHJzID0gc3VyZV9zdGFydF9hdHRycywNCj4gIH07DQo+IA0KPiArDQo+ICtz
dGF0aWMgaW50IGNvbnZlcnRfaGV4c3RyX3RvX3N0cihjaGFyICoqaGV4LCBpbnQgaW5wdXRfbGVu
LCBjaGFyICoqc3RyLCBpbnQNCj4gKmxlbikNCj4gK3sNCj4gKwlpbnQgcmV0ID0gMDsNCj4gKwlp
bnQgbmV3X2xlbiA9IDA7DQo+ICsJY2hhciB0bXBbXSA9ICIweDAwIjsNCj4gKwljaGFyICppbnB1
dCA9ICpoZXg7DQo+ICsJY2hhciAqbmV3X3N0ciA9IE5VTEw7DQo+ICsJaW50ICBjaDsNCj4gKwlp
bnQgaTsNCj4gKw0KPiArCWlmIChpbnB1dF9sZW4gPD0gMCB8fCBoZXggPT0gTlVMTCB8fCBzdHIg
PT0gTlVMTCB8fCBsZW4gPT0gTlVMTCkNCj4gKwkJcmV0dXJuIC1FSU5WQUw7DQo+ICsNCj4gKwkq
bGVuID0gMDsNCj4gKwkqc3RyID0gTlVMTDsNCj4gKw0KPiArCW5ld19zdHIgPSBrbWFsbG9jKGlu
cHV0X2xlbiwgR0ZQX0tFUk5FTCk7DQo+ICsJaWYgKCFuZXdfc3RyKQ0KPiArCQlyZXR1cm4gLUVO
T01FTTsNCj4gKw0KPiArCWZvciAoaSA9IDA7IGkgPCBpbnB1dF9sZW47IGkgKz0gNSkgew0KPiAr
CQlzdHJuY3B5KHRtcCwgaW5wdXQgKyBpLCBzdHJsZW4odG1wKSk7DQo+ICsJCXJldCA9IGtzdHJ0
b2ludCh0bXAsIDE2LCAmY2gpOw0KPiArCQlpZiAocmV0KSB7DQo+ICsJCQluZXdfbGVuID0gMDsN
Cj4gKwkJCWJyZWFrOw0KPiArCQl9DQo+ICsNCj4gKwkJaWYgKGNoID09ICdcXCcpDQo+ICsJCQlu
ZXdfc3RyW25ld19sZW4rK10gPSAnXFwnOw0KPiArDQo+ICsJCW5ld19zdHJbbmV3X2xlbisrXSA9
IGNoOw0KPiArCQlpZiAoY2ggPT0gJ1wwJykNCj4gKwkJCWJyZWFrOw0KPiArCX0NCj4gKw0KPiAr
CWlmIChuZXdfbGVuKSB7DQo+ICsJCW5ld19zdHJbbmV3X2xlbl0gPSAnXDAnOw0KPiArCQkqc3Ry
ID0ga3JlYWxsb2MobmV3X3N0ciwgKG5ld19sZW4gKyAxKSAqIHNpemVvZihjaGFyKSwNCj4gR0ZQ
X0tFUk5FTCk7DQo+ICsJCWlmICgqc3RyKQ0KPiArCQkJKmxlbiA9IG5ld19sZW47DQo+ICsJCWVs
c2UNCj4gKwkJCXJldCA9IC1FTk9NRU07DQo+ICsJfQ0KPiArDQo+ICsJaWYgKHJldCkNCj4gKwkJ
a2ZyZWUobmV3X3N0cik7DQo+ICsJcmV0dXJuIHJldDsNCj4gK30NCj4gKw0KPiArLyoNCj4gKyAq
IGhwX3dtaV9nZXRfc2V0dGluZ19vYmplY3QoKSAtIEdldCBhbiBBQ1BJIG9iamVjdCBieSBHVUlE
IGFuZCBpbnN0YW5jZQ0KPiArICoNCj4gKyAqIEBndWlkOglHVUlEIGFzc29jaWF0ZWQgd2l0aCB0
aGUgQUNQSSBsaXN0IG9mIG1hbmFnZWQgb2JqZWN0cw0KPiArICogQGluc3RhbmNlOglJbnN0YW5j
ZSBpbmRleCB0byBxdWVyeSBvbiB0aGUgQUNQSSBsaXN0DQo+ICsgKiBAb2JqOglUaGUgb3V0cHV0
IEFDUEkgb2JqZWN0IG9mIHR5cGUgQUNQSV9UWVBFX1BBQ0tBR0UNCj4gKyAqCQlvciBBQ1BJX1RZ
UEVfQlVGRkVSIChmcmVlZCBieSB0aGUgY2FsbGVlKQ0KPiArICoNCj4gKyAqIFJldHVybnMJemVy
byBvbiBzdWNjZXNzLiAgT3RoZXJ3aXNlLGFuIGVycm9yIGluaGVyaXRlZCBmcm9tDQo+ICsgKgkJ
d21pX3F1ZXJ5X2Jsb2NrKCkuIEl0IHJldHVybnMgYSBvYmogYnkgcGFyYW1ldGVyIGlmDQo+ICsg
KgkJdGhlIHF1ZXJ5IHJldHVybmVkIG9iamVjdCBvZiB0eXBlIGJ1ZmZlciBvciBwYWNrYWdlLA0K
PiArICoJCW90aGVyd2lzZSwgYSBudWxsIG9iaiBpcyByZXR1cm5lZC4NCj4gKyAqDQo+ICsgKiBO
b3RlOiBvYmogc2hvdWxkIGJlIGZyZWVkIGJ5IHRoZSBjYWxsZWUgb25jZSBpdCBpcyBmaW5pc2hl
ZCB3b3JraW5nIHdpdGggaXQNCj4gKyAqLw0KPiArc3RhdGljIGludCBocF93bWlfZ2V0X3NldHRp
bmdfb2JqZWN0KGNoYXIgKmd1aWQsIGludCBpbnN0YW5jZSwNCj4gKwkJCQl1bmlvbiBhY3BpX29i
amVjdCAqKm9iaikNCj4gK3sNCj4gKwlzdHJ1Y3QgYWNwaV9idWZmZXIgb3V0cHV0ID0geyBBQ1BJ
X0FMTE9DQVRFX0xPQ0FMX0JVRkZFUiwgTlVMTA0KPiB9Ow0KPiArCXVuaW9uIGFjcGlfb2JqZWN0
ICp0bXAgPSBOVUxMOw0KPiArCWludCByZXQ7DQo+ICsNCj4gKwlyZXQgPSB3bWlfcXVlcnlfYmxv
Y2soZ3VpZCwgaW5zdGFuY2UsICZvdXRwdXQpOw0KPiArCWlmIChBQ1BJX1NVQ0NFU1MocmV0KSAm
JiBvdXRwdXQucG9pbnRlciAhPSBOVUxMKSB7DQo+ICsJCXRtcCA9IG91dHB1dC5wb2ludGVyOw0K
PiArCQlpZiAodG1wLT50eXBlID09IEFDUElfVFlQRV9CVUZGRVIgfHwgdG1wLT50eXBlID09DQo+
IEFDUElfVFlQRV9QQUNLQUdFKQ0KPiArCQkJKm9iaiA9IG91dHB1dC5wb2ludGVyOw0KPiArCQll
bHNlIHsNCj4gKwkJCWtmcmVlKHRtcCk7DQo+ICsJCQkqb2JqID0gTlVMTDsNCj4gKwkJfQ0KPiAr
CX0NCj4gKw0KPiArCXJldHVybiByZXQ7DQo+ICt9DQo+ICsNCj4gKw0KPiArc3RhdGljIGludCBn
ZXRfc3RyaW5nX2Zyb21fYnVmZmVyKHUxNiAqKmJ1ZmZlciwgY2hhciAqKnN0cikNCj4gK3sNCj4g
Kwl1MTYgKnB0ciA9ICpidWZmZXI7DQo+ICsJdTE2IHB0cmxlbjsNCj4gKw0KPiArCXUxNiBzaXpl
Ow0KPiArCWludCBpOw0KPiArCWNoYXIgKm91dHB1dCA9IE5VTEw7DQo+ICsJaW50IGVzY2FwZSA9
IDA7DQo+ICsNCj4gKwlwdHJsZW4gPSAqKHB0cisrKTsNCj4gKwlzaXplID0gcHRybGVuIC8gMjsN
Cj4gKw0KPiArCWlmIChzaXplID09IDApDQo+ICsJCWdvdG8gY2xlYW51cF9leGl0Ow0KPiArDQo+
ICsJZm9yIChpID0gMDsgaSA8IHNpemU7IGkrKykNCj4gKwkJaWYgKHB0cltpXSA9PSAnXFwnKQ0K
PiArCQkJZXNjYXBlKys7DQo+ICsNCj4gKwlzaXplICs9IGVzY2FwZTsNCj4gKwkqc3RyID0ga2Nh
bGxvYyhzaXplICsgMSwgc2l6ZW9mKGNoYXIpLCBHRlBfS0VSTkVMKTsNCj4gKwlpZiAoISpzdHIp
DQo+ICsJCXJldHVybiAtRU5PTUVNOw0KPiArDQo+ICsJb3V0cHV0ID0gKnN0cjsNCj4gKw0KPiAr
CS8qDQo+ICsJICogY29udmVydCBmcm9tIFVURi0xNiB1bmljb2RlIHRvIEFTQ0lJDQo+ICsJICov
DQo+ICsJdXRmMTZzX3RvX3V0ZjhzKHB0ciwgcHRybGVuLCBVVEYxNl9IT1NUX0VORElBTiwgb3V0
cHV0LCBzaXplKTsNCj4gKw0KPiArCWlmIChlc2NhcGUgPT0gMCkgew0KPiArCQlwdHIgKz0gKHB0
cmxlbiAvIDIpOw0KPiArCQlnb3RvIGNsZWFudXBfZXhpdDsNCj4gKwl9DQo+ICsJLyoNCj4gKwkg
KiBDb252ZXJ0IGVzY2FwZSBjaGFyYWN0ZXJzIG9ubHkgd2hlbiBmb3VuZA0KPiArCSAqLw0KPiAr
CWZvciAoaSA9IDA7IGkgPCBzaXplOyBpKyspIHsNCj4gKwkJaWYgKCpwdHIgPT0gJ1xcJykNCj4g
KwkJCW91dHB1dFtpKytdID0gJ1xcJzsNCj4gKwkJb3V0cHV0W2ldID0gKnB0cjsNCj4gKwkJcHRy
Kys7DQo+ICsJfQ0KPiArDQo+ICtjbGVhbnVwX2V4aXQ6DQo+ICsJKmJ1ZmZlciA9IHB0cjsNCj4g
KwlyZXR1cm4gMDsNCj4gK30NCj4gKw0KPiArc3RhdGljIGludCBnZXRfaW50ZWdlcl9mcm9tX2J1
ZmZlcihpbnQgKipidWZmZXIsIGludCAqaW50ZWdlcikNCj4gK3sNCj4gKwlpbnQgKnB0ciA9IFBU
Ul9BTElHTigqYnVmZmVyLCA0KTsNCj4gKwkqaW50ZWdlciA9ICoocHRyKyspOw0KPiArCSpidWZm
ZXIgPSBwdHI7DQo+ICsJcmV0dXJuIDA7DQo+ICt9DQo+ICsNCj4gKw0KPiArLy8gU3VyZSBBZG1p
biBmdW5jdGlvbnMNCj4gK2VudW0gaHBfd21pX2RhdGFfdHlwZSB7DQo+ICsJSFBXTUlfU1RSSU5H
X1RZUEUsDQo+ICsJSFBXTUlfSU5URUdFUl9UWVBFLA0KPiArCUhQV01JX0VOVU1FUkFUSU9OX1RZ
UEUsDQo+ICsJSFBXTUlfT1JERVJFRExJU1RfVFlQRSwNCj4gKwlIUFdNSV9QQVNTV09SRF9UWVBF
LA0KPiArfTsNCj4gKw0KPiArI2RlZmluZSBIUF9XTUlfQ09NTU9OX0VMRU1FTlRTCVwNCj4gKwki
TmFtZSIsCVwNCj4gKwkiVmFsdWUiLAlcDQo+ICsJIlBhdGgiLAlcDQo+ICsJIklzUmVhZE9ubHki
LAlcDQo+ICsJIkRpc3BsYXlJblVJIiwJXA0KPiArCSJSZXF1aXJlc1BoeXNpY2FsUHJlc2VuY2Ui
LAlcDQo+ICsJIlNlcXVlbmNlIiwJXA0KPiArCSJQcmVyZXF1aXNpdGVTaXplIiwJXA0KPiArCSJT
ZWN1cml0eUxldmVsIg0KPiArDQo+ICtjb25zdCBjaGFyICpocF93bWlfc3RyaW5nX2VsZW1lbnRz
W10gPSB7DQo+ICsJSFBfV01JX0NPTU1PTl9FTEVNRU5UUywNCj4gKwkiTWluTGVuZ3RoIiwNCj4g
KwkiTWF4TGVuZ3RoIg0KPiArfTsNCj4gKw0KPiArY29uc3QgY2hhciAqaHBfd21pX2ludGVnZXJf
ZWxlbWVudHNbXSA9IHsNCj4gKwlIUF9XTUlfQ09NTU9OX0VMRU1FTlRTLA0KPiArCSJMb3dlckJv
dW5kIiwNCj4gKwkiVXBwZXJCb3VuZCIsDQo+ICsJIkludFZhbHVlIg0KPiArfTsNCj4gKw0KPiAr
Y29uc3QgY2hhciAqaHBfd21pX2VudW1lcmF0aW9uX2VsZW1lbnRzW10gPSB7DQo+ICsJSFBfV01J
X0NPTU1PTl9FTEVNRU5UUywNCj4gKwkiQ3VycmVudFZhbHVlIiwNCj4gKwkiU2l6ZSINCj4gK307
DQo+ICsNCj4gK2NvbnN0IGNoYXIgKmhwX3dtaV9vcmRlcmVkbGlzdF9lbGVtZW50c1tdID0gew0K
PiArCUhQX1dNSV9DT01NT05fRUxFTUVOVFMsDQo+ICsJIlNpemUiDQo+ICt9Ow0KPiArDQo+ICtj
b25zdCBjaGFyICpocF93bWlfcGFzc3dvcmRfZWxlbWVudHNbXSA9IHsNCj4gKwlIUF9XTUlfQ09N
TU9OX0VMRU1FTlRTLA0KPiArCSJNaW5MZW5ndGgiLA0KPiArCSJNYXhMZW5ndGgiLA0KPiArCSJT
aXplIiwNCj4gKwkiU3VwcG9ydGVkRW5jb2RpbmciLA0KPiArCSJJc1NldCINCj4gK307DQo+ICsN
Cj4gK2NvbnN0IGNoYXIgKipocF93bWlfZWxlbWVudHNbXSA9IHsNCj4gKwlocF93bWlfc3RyaW5n
X2VsZW1lbnRzLA0KPiArCWhwX3dtaV9pbnRlZ2VyX2VsZW1lbnRzLA0KPiArCWhwX3dtaV9lbnVt
ZXJhdGlvbl9lbGVtZW50cywNCj4gKwlocF93bWlfb3JkZXJlZGxpc3RfZWxlbWVudHMsDQo+ICsJ
aHBfd21pX3Bhc3N3b3JkX2VsZW1lbnRzDQo+ICt9Ow0KPiArDQo+ICtjb25zdCBpbnQgaHBfd21p
X2VsZW1lbnRzX2NvdW50W10gPSB7DQo+ICsJQVJSQVlfU0laRShocF93bWlfc3RyaW5nX2VsZW1l
bnRzKSwNCj4gKwlBUlJBWV9TSVpFKGhwX3dtaV9pbnRlZ2VyX2VsZW1lbnRzKSwNCj4gKwlBUlJB
WV9TSVpFKGhwX3dtaV9lbnVtZXJhdGlvbl9lbGVtZW50cyksDQo+ICsJQVJSQVlfU0laRShocF93
bWlfb3JkZXJlZGxpc3RfZWxlbWVudHMpLA0KPiArCUFSUkFZX1NJWkUoaHBfd21pX3Bhc3N3b3Jk
X2VsZW1lbnRzKQ0KPiArfTsNCj4gKw0KPiArY29uc3QgY2hhciAqaHBfd21pX2NsYXNzZXNbXSA9
IHsNCj4gKwkiSFBCSU9TX0JJT1NTdHJpbmciLA0KPiArCSJIUEJJT1NfQklPU0ludGVnZXIiLA0K
PiArCSJIUEJJT1NfQklPU0VudW1lcmF0aW9uIiwNCj4gKwkiSFBCSU9TX0JJT1NPcmRlcmVkTGlz
dCIsDQo+ICsJIkhQQklPU19CSU9TUGFzc3dvcmQiDQo+ICt9Ow0KPiArDQo+ICtzdGF0aWMgREVG
SU5FX01VVEVYKGJ1Zl9tdXRleCk7DQo+ICtzdGF0aWMgaW50IHNldHRpbmdzX2J1ZmZlcl9zaXpl
Ow0KPiArc3RhdGljIGludCBidWZfYWxsb2Nfc2l6ZTsNCj4gK3N0YXRpYyBjaGFyICpocF9iaW9z
X3NldHRpbmdzX2J1ZmZlcjsNCj4gKw0KPiArDQo+ICtzdGF0aWMgaW50IGFwcGVuZF9wYWNrYWdl
X2VsZW1lbnRzX3RvX2J1ZmZlcih1bmlvbiBhY3BpX29iamVjdCAqb2JqLA0KPiArCQkJCQkgICAg
IGNoYXIgKmJ1ZiwgaW50IGFsbG9jX3NpemUsIGVudW0NCj4gaHBfd21pX2RhdGFfdHlwZSB0eXBl
KQ0KPiArew0KPiArCWludCBpOw0KPiArCXVuaW9uIGFjcGlfb2JqZWN0ICpwb2JqID0gTlVMTDsN
Cj4gKwljaGFyICp2YWx1ZSA9IE5VTEw7DQo+ICsJaW50IHZhbHVlX2xlbjsNCj4gKwljaGFyICp0
bXBzdHIgPSBOVUxMOw0KPiArCWNoYXIgKnBhcnRfdG1wID0gTlVMTDsNCj4gKwlpbnQgdG1wX2xl
biA9IDA7DQo+ICsJY2hhciAqcGFydCA9IE5VTEw7DQo+ICsJaW50IHN0YXR1cyA9IDA7DQo+ICsJ
aW50IHNpemUgPSAwOw0KPiArCWludCBidWZfc2l6ZTsNCj4gKw0KPiArCWlmICh0eXBlID49IEFS
UkFZX1NJWkUoaHBfd21pX2NsYXNzZXMpIHx8ICFidWYgfHwgIW9iaikNCj4gKwkJcmV0dXJuIC1F
SU5WQUw7DQo+ICsNCj4gKwlpZiAob2JqLT50eXBlICE9IEFDUElfVFlQRV9QQUNLQUdFKQ0KPiAr
CQlyZXR1cm4gLUVJTlZBTDsNCj4gKw0KPiArCWJ1Zl9zaXplID0gc25wcmludGYoYnVmLCBhbGxv
Y19zaXplLCAiJXN7XG4iLCBidWYpOw0KPiArCWJ1Zl9zaXplID0gc25wcmludGYoYnVmLCBhbGxv
Y19zaXplLCAiJXNcdFwiQ2xhc3NcIjogXCIlc1wiLFxuIiwgYnVmLA0KPiBocF93bWlfY2xhc3Nl
c1t0eXBlXSk7DQo+ICsNCj4gKwlmb3IgKGkgPSAwOyBpIDwgMzsgaSsrKSB7DQo+ICsJCXBvYmog
PSAmKG9iai0+cGFja2FnZS5lbGVtZW50c1tpXSk7DQo+ICsJCWlmIChwb2JqLT50eXBlID09IEFD
UElfVFlQRV9TVFJJTkcpIHsNCj4gKwkJCXN0YXR1cyA9IGNvbnZlcnRfaGV4c3RyX3RvX3N0cigm
cG9iai0NCj4gPnN0cmluZy5wb2ludGVyLA0KPiArCQkJCQkJICAgICAgIHBvYmotPnN0cmluZy5s
ZW5ndGgsDQo+ICZ2YWx1ZSwgJnZhbHVlX2xlbik7DQo+ICsJCQlpZiAoQUNQSV9GQUlMVVJFKHN0
YXR1cykpDQo+ICsJCQkJY29udGludWU7DQo+ICsJCQkvKg0KPiArCQkJICogU2tpcCAnVmFsdWUn
IChIUF9XTUlfQ09NTU9OX0VMRU1FTlRTKQ0KPiBzaW5jZQ0KPiArCQkJICogJ0N1cnJlbnRWYWx1
ZScgaXMgcmVwb3J0ZWQuDQo+ICsJCQkgKi8NCj4gKwkJCWlmICh0eXBlICE9IEhQV01JX0VOVU1F
UkFUSU9OX1RZUEUgfHwgaSAhPSAxKQ0KPiArCQkJCWJ1Zl9zaXplID0gc25wcmludGYoYnVmLCBh
bGxvY19zaXplLA0KPiArCQkJCQkJICAgICIlc1x0XCIlc1wiOiBcIiVzXCIsXG4iLA0KPiArCQkJ
CQkJICAgIGJ1ZiwNCj4gKw0KPiBocF93bWlfZWxlbWVudHNbdHlwZV1baV0sIHZhbHVlKTsNCj4g
Kw0KPiArCQl9DQo+ICsJCWtmcmVlKHZhbHVlKTsNCj4gKwkJdmFsdWUgPSBOVUxMOw0KPiArCX0N
Cj4gKw0KPiArCWZvciAoaSA9IDM7IGkgPCBocF93bWlfZWxlbWVudHNfY291bnRbdHlwZV07IGkr
Kykgew0KPiArCQlwb2JqID0gJihvYmotPnBhY2thZ2UuZWxlbWVudHNbaV0pOw0KPiArDQo+ICsJ
CWlmICh0eXBlID09IEhQV01JX0VOVU1FUkFUSU9OX1RZUEUgJiYNCj4gKwkJICAgIGkgPT0gOSAm
Jg0KPiArCQkgICAgcG9iai0+dHlwZSA9PSBBQ1BJX1RZUEVfU1RSSU5HKSB7DQo+ICsJCQkvKg0K
PiArCQkJICogUmVwb3J0ICJDdXJyZW50VmFsdWUiIGFzICJWYWx1ZSINCj4gKwkJCSAqLw0KPiAr
CQkJc3RhdHVzID0gY29udmVydF9oZXhzdHJfdG9fc3RyKCZwb2JqLQ0KPiA+c3RyaW5nLnBvaW50
ZXIsDQo+ICsJCQkJCQkgICAgICAgcG9iai0+c3RyaW5nLmxlbmd0aCwNCj4gKwkJCQkJCSAgICAg
ICAmdmFsdWUsICZ2YWx1ZV9sZW4pOw0KPiArCQkJaWYgKEFDUElfRkFJTFVSRShzdGF0dXMpKQ0K
PiArCQkJCWNvbnRpbnVlOw0KPiArDQo+ICsJCQlidWZfc2l6ZSA9IHNucHJpbnRmKGJ1ZiwgYWxs
b2Nfc2l6ZSwNCj4gKwkJCQkJICAgICIlc1x0XCJWYWx1ZVwiOiBcIiVzXCIsXG4iLA0KPiArCQkJ
CQkgICAgYnVmLCB2YWx1ZSk7DQo+ICsJCQlrZnJlZSh2YWx1ZSk7DQo+ICsJCQl2YWx1ZSA9IE5V
TEw7DQo+ICsNCj4gKwkJfSBlbHNlIGlmICh0eXBlID09IEhQV01JX1BBU1NXT1JEX1RZUEUgJiYN
Cj4gKwkJCSAgIGkgPT0gMTIgJiYNCj4gKwkJCSAgIHBvYmotPnR5cGUgPT0gQUNQSV9UWVBFX1NU
UklORykgew0KPiArCQkJLyoNCj4gKwkJCSAqIFJlcG9ydCBsaXN0IG9mICJTdXBwb3J0RW5jb2Rp
bmciDQo+ICsJCQkgKg0KPiArCQkJICoJIlN1cHBvcnRlZEVuY29kaW5nIjogWw0KPiArCQkJICoJ
CSJ1dGYtMTYiDQo+ICsJCQkgKgldLA0KPiArCQkJICoNCj4gKwkJCSAqLw0KPiArDQo+ICsJCQli
dWZfc2l6ZSA9IHNucHJpbnRmKGJ1ZiwgYWxsb2Nfc2l6ZSwgIiVzXHRcIiVzXCI6IFtcbiIsDQo+
ICsJCQkJCSAgICBidWYsIGhwX3dtaV9lbGVtZW50c1t0eXBlXVtpXSk7DQo+ICsJCQl3aGlsZSAo
c2l6ZS0tKSB7DQo+ICsJCQkJcG9iaiA9ICYob2JqLT5wYWNrYWdlLmVsZW1lbnRzW2ldKTsNCj4g
KwkJCQlzdGF0dXMgPSBjb252ZXJ0X2hleHN0cl90b19zdHIoJnBvYmotDQo+ID5zdHJpbmcucG9p
bnRlciwNCj4gKwkJCQkJCQkgICAgICAgcG9iai0NCj4gPnN0cmluZy5sZW5ndGgsDQo+ICsJCQkJ
CQkJICAgICAgICZ2YWx1ZSwNCj4gJnZhbHVlX2xlbik7DQo+ICsJCQkJaWYgKEFDUElfRkFJTFVS
RShzdGF0dXMpKQ0KPiArCQkJCQljb250aW51ZTsNCj4gKw0KPiArCQkJCWlmIChzaXplKSB7DQo+
ICsJCQkJCWJ1Zl9zaXplID0gc25wcmludGYoYnVmLCBhbGxvY19zaXplLA0KPiArCQkJCQkJCSAg
ICAiJXNcdFx0XCIlc1wiLFxuIiwNCj4gYnVmLCB2YWx1ZSk7DQo+ICsJCQkJCWkrKzsNCj4gKwkJ
CQl9IGVsc2UNCj4gKwkJCQkJYnVmX3NpemUgPSBzbnByaW50ZihidWYsIGFsbG9jX3NpemUsDQo+
ICsJCQkJCQkJICAgICIlc1x0XHRcIiVzXCJcbiIsDQo+IGJ1ZiwgdmFsdWUpOw0KPiArDQo+ICsJ
CQkJa2ZyZWUodmFsdWUpOw0KPiArCQkJCXZhbHVlID0gTlVMTDsNCj4gKw0KPiArCQkJfQ0KPiAr
CQkJYnVmX3NpemUgPSBzbnByaW50ZihidWYsIGFsbG9jX3NpemUsICIlc1x0XSxcbiIsIGJ1Zik7
DQo+ICsJCQljb250aW51ZTsNCj4gKw0KPiArCQl9IGVsc2UgaWYgKHBvYmotPnR5cGUgPT0gQUNQ
SV9UWVBFX0lOVEVHRVIpIHsNCj4gKwkJCS8qDQo+ICsJCQkgKiBSZXBvcnQgIlByZXJlcXVpc2l0
ZVNpemUiIGFuZCAiU2l6ZSIgdmFsdWVzDQo+ICsJCQkgKgkuLi4NCj4gKwkJCSAqCSJQcmVyZXF1
aXNpdGVTaXplIjogMSwNCj4gKwkJCSAqCS4uLg0KPiArCQkJICoJIlNpemUiOiAyLA0KPiArCQkJ
ICoJLi4uDQo+ICsJCQkgKi8NCj4gKwkJCWlmIChpID09IDcpDQo+ICsJCQkJc2l6ZSA9IHBvYmot
PmludGVnZXIudmFsdWU7DQo+ICsJCQllbHNlIGlmICh0eXBlID09IEhQV01JX09SREVSRURMSVNU
X1RZUEUgJiYgaSA9PQ0KPiA5KQ0KPiArCQkJCXNpemUgPSBwb2JqLT5pbnRlZ2VyLnZhbHVlOw0K
PiArCQkJZWxzZSBpZiAodHlwZSA9PSBIUFdNSV9FTlVNRVJBVElPTl9UWVBFICYmIGkNCj4gPT0g
MTApDQo+ICsJCQkJc2l6ZSA9IHBvYmotPmludGVnZXIudmFsdWU7DQo+ICsJCQllbHNlIGlmICh0
eXBlID09IEhQV01JX1BBU1NXT1JEX1RZUEUgJiYgaSA9PQ0KPiAxMSkNCj4gKwkJCQlzaXplID0g
cG9iai0+aW50ZWdlci52YWx1ZTsNCj4gKw0KPiArCQkJYnVmX3NpemUgPSBzbnByaW50ZihidWYs
IGFsbG9jX3NpemUsICIlc1x0XCIlc1wiOg0KPiAlbGxkLFxuIiwgYnVmLA0KPiArCQkJCQkgICAg
aHBfd21pX2VsZW1lbnRzW3R5cGVdW2ldLCBwb2JqLQ0KPiA+aW50ZWdlci52YWx1ZSk7DQo+ICsJ
CX0NCj4gKwl9DQo+ICsNCj4gKwlpZiAodHlwZSA9PSBIUFdNSV9FTlVNRVJBVElPTl9UWVBFKSB7
DQo+ICsJCWJ1Zl9zaXplID0gc25wcmludGYoYnVmLCBhbGxvY19zaXplLCAiJXNcdFwiUG9zc2li
bGVWYWx1ZXNcIjoNCj4gW1xuIiwgYnVmKTsNCj4gKwkJZm9yIChpID0gMDsgaSA8IHNpemU7IGkr
Kykgew0KPiArCQkJcG9iaiA9ICYob2JqLT5wYWNrYWdlLmVsZW1lbnRzW2kgKw0KPiBocF93bWlf
ZWxlbWVudHNfY291bnRbdHlwZV1dKTsNCj4gKw0KPiArCQkJc3RhdHVzID0gY29udmVydF9oZXhz
dHJfdG9fc3RyKCZwb2JqLQ0KPiA+c3RyaW5nLnBvaW50ZXIsDQo+ICsJCQkJCQkgICAgICAgcG9i
ai0+c3RyaW5nLmxlbmd0aCwNCj4gKwkJCQkJCSAgICAgICAmdmFsdWUsICZ2YWx1ZV9sZW4pOw0K
PiArCQkJaWYgKEFDUElfRkFJTFVSRShzdGF0dXMpKQ0KPiArCQkJCWJyZWFrOw0KPiArDQo+ICsJ
CQkvKg0KPiArCQkJICogUmVwb3J0IGxpc3Qgb2YgIlBvc3NpYmxlVmFsdWVzIiBvZiBzaXplDQo+
ICsJCQkgKiAiU2l6ZSINCj4gKwkJCSAqCS4uLg0KPiArCQkJICoJIlNpemUiOiAyLA0KPiArCQkJ
ICoJIlBvc3NpYmxlVmFsdWVzIjogWw0KPiArCQkJICoJCQkiRGlzYWJsZSIsDQo+ICsJCQkgKgkJ
CSJFbmFibGUiXQ0KPiArCQkJICovDQo+ICsJCQlpZiAoaSA9PSAoc2l6ZSAtIDEpKQ0KPiArCQkJ
CWJ1Zl9zaXplID0gc25wcmludGYoYnVmLCBhbGxvY19zaXplLA0KPiArCQkJCQkJICAgICIlc1x0
XHRcIiVzXCJcbiIsIGJ1ZiwNCj4gdmFsdWUpOw0KPiArCQkJZWxzZQ0KPiArCQkJCWJ1Zl9zaXpl
ID0gc25wcmludGYoYnVmLCBhbGxvY19zaXplLA0KPiArCQkJCQkJICAgICIlc1x0XHRcIiVzXCIs
XG4iLCBidWYsDQo+IHZhbHVlKTsNCj4gKwkJCWtmcmVlKHZhbHVlKTsNCj4gKwkJCXZhbHVlID0g
TlVMTDsNCj4gKwkJfQ0KPiArCQlidWZfc2l6ZSA9IHNucHJpbnRmKGJ1ZiwgYWxsb2Nfc2l6ZSwg
IiVzXHRdLFxuIiwgYnVmKTsNCj4gKwl9DQo+ICsNCj4gKwlpZiAodHlwZSA9PSBIUFdNSV9PUkRF
UkVETElTVF9UWVBFKSB7DQo+ICsJCWJ1Zl9zaXplID0gc25wcmludGYoYnVmLCBhbGxvY19zaXpl
LCAiJXNcdFwiRWxlbWVudHNcIjogW1xuIiwNCj4gYnVmKTsNCj4gKwkJaWYgKHNpemUgPD0gMCkN
Cj4gKwkJCWdvdG8gZmluaXNoX29yZGVyZWRfbGlzdDsNCj4gKw0KPiArCQlwb2JqID0gJihvYmot
DQo+ID5wYWNrYWdlLmVsZW1lbnRzW2hwX3dtaV9lbGVtZW50c19jb3VudFt0eXBlXV0pOw0KPiAr
CQlzdGF0dXMgPSBjb252ZXJ0X2hleHN0cl90b19zdHIoJnBvYmotPnN0cmluZy5wb2ludGVyLA0K
PiArCQkJCQkgICAgICAgcG9iai0+c3RyaW5nLmxlbmd0aCwgJnZhbHVlLA0KPiAmdmFsdWVfbGVu
KTsNCj4gKwkJaWYgKEFDUElfRkFJTFVSRShzdGF0dXMpKQ0KPiArCQkJZ290byBmaW5pc2hfb3Jk
ZXJlZF9saXN0Ow0KPiArDQo+ICsJCS8qDQo+ICsJCSAqIE9yZGVyZWQgbGlzdCBkYXRhIGlzIHN0
b3JlZCBpbiBoZXggYW5kIGNvbW1hIHNlcGFyYXRlZA0KPiBmb3JtYXQNCj4gKwkJICogQ29udmVy
dCB0aGUgZGF0YSBhbmQgc3BsaXQgaXQgdG8gc2hvdyBlYWNoIGVsZW1lbnQNCj4gKwkJICovDQo+
ICsJCXN0YXR1cyA9IGNvbnZlcnRfaGV4c3RyX3RvX3N0cigmdmFsdWUsIHZhbHVlX2xlbiwgJnRt
cHN0ciwNCj4gJnRtcF9sZW4pOw0KPiArCQlpZiAoQUNQSV9GQUlMVVJFKHN0YXR1cykpDQo+ICsJ
CQlnb3RvIGZpbmlzaF9vcmRlcmVkX2xpc3Q7DQo+ICsNCj4gKwkJcGFydF90bXAgPSB0bXBzdHI7
DQo+ICsJCXBhcnQgPSBzdHJzZXAoJnBhcnRfdG1wLCAiLCIpOw0KPiArCQl3aGlsZSAocGFydCkg
ew0KPiArCQkJYnVmX3NpemUgPSBzbnByaW50ZihidWYsIGFsbG9jX3NpemUsICIlc1x0XHRcIiVz
XCIiLA0KPiBidWYsIHBhcnQpOw0KPiArCQkJcGFydCA9IHN0cnNlcCgmcGFydF90bXAsICIsIik7
DQo+ICsJCQlpZiAocGFydCkNCj4gKwkJCQlidWZfc2l6ZSA9IHNucHJpbnRmKGJ1ZiwgYWxsb2Nf
c2l6ZSwgIiVzLFxuIiwNCj4gYnVmKTsNCj4gKwkJCWVsc2UNCj4gKwkJCQlidWZfc2l6ZSA9IHNu
cHJpbnRmKGJ1ZiwgYWxsb2Nfc2l6ZSwgIiVzXG4iLA0KPiBidWYpOw0KPiArCQl9DQo+ICsJfQ0K
PiArDQo+ICtmaW5pc2hfb3JkZXJlZF9saXN0Og0KPiArCWlmICh0eXBlID09IEhQV01JX09SREVS
RURMSVNUX1RZUEUpDQo+ICsJCWJ1Zl9zaXplID0gc25wcmludGYoYnVmLCBhbGxvY19zaXplLCAi
JXNcdF0sXG4iLCBidWYpOw0KPiArDQo+ICsJLyoNCj4gKwkgKiByZW1vdmUgdHJhaWxpbmcgY29t
bWENCj4gKwkgKi8NCj4gKwlpZiAoYnVmX3NpemUgPiAzKQ0KPiArCQlidWZbYnVmX3NpemUgLSAy
XSA9ICcgJzsNCj4gKw0KPiArCWtmcmVlKHRtcHN0cik7DQo+ICsJa2ZyZWUodmFsdWUpOw0KPiAr
CXJldHVybiBzbnByaW50ZihidWYsIGFsbG9jX3NpemUsICIlc30sXG4iLCBidWYpOw0KPiArfQ0K
PiArDQo+ICtzdGF0aWMgaW50IGFwcGVuZF9idWZmZXJfZWxlbWVudHNfdG9fYnVmZmVyKHVuaW9u
IGFjcGlfb2JqZWN0ICpvYmosDQo+ICsJCQkJCSAgICBjaGFyICpidWYsIGludCBhbGxvY19zaXpl
LCBlbnVtDQo+IGhwX3dtaV9kYXRhX3R5cGUgdHlwZSkNCj4gK3sNCj4gKwlpbnQgYnVmX3NpemU7
DQo+ICsJaW50IHN0YXR1czsNCj4gKwljaGFyICpzdHIgPSBOVUxMOw0KPiArCWludCBpOw0KPiAr
CWludCBqOw0KPiArCWludCBpbnRlZ2VyOw0KPiArCWludCBzaXplID0gMDsNCj4gKw0KPiArCWlm
ICh0eXBlID49IEFSUkFZX1NJWkUoaHBfd21pX2NsYXNzZXMpIHx8ICFidWYgfHwgIW9iaikNCj4g
KwkJcmV0dXJuIC1FSU5WQUw7DQo+ICsNCj4gKwlpZiAob2JqLT50eXBlICE9IEFDUElfVFlQRV9C
VUZGRVIpDQo+ICsJCXJldHVybiAtRUlOVkFMOw0KPiArDQo+ICsJYnVmX3NpemUgPSBzbnByaW50
ZihidWYsIGFsbG9jX3NpemUsICIlc3tcbiIsIGJ1Zik7DQo+ICsJYnVmX3NpemUgPSBzbnByaW50
ZihidWYsIGFsbG9jX3NpemUsICIlc1x0XCJDbGFzc1wiOiBcIiVzXCIsXG4iLCBidWYsDQo+IGhw
X3dtaV9jbGFzc2VzW3R5cGVdKTsNCj4gKw0KPiArCWZvciAoaSA9IDA7IGkgPCAzOyBpKyspIHsN
Cj4gKwkJc3RhdHVzID0gZ2V0X3N0cmluZ19mcm9tX2J1ZmZlcigodTE2ICoqKSZvYmotDQo+ID5i
dWZmZXIucG9pbnRlciwgJnN0cik7DQo+ICsJCWlmIChBQ1BJX1NVQ0NFU1Moc3RhdHVzKSkgew0K
PiArCQkJLyoNCj4gKwkJCSAqIFNraXAgJ1ZhbHVlJyAoSFBfV01JX0NPTU1PTl9FTEVNRU5UUykN
Cj4gc2luY2UNCj4gKwkJCSAqICdDdXJyZW50VmFsdWUnIGlzIHJlcG9ydGVkLg0KPiArCQkJICov
DQo+ICsJCQlpZiAodHlwZSAhPSBIUFdNSV9FTlVNRVJBVElPTl9UWVBFIHx8IGkgIT0gMSkNCj4g
KwkJCQlidWZfc2l6ZSA9IHNucHJpbnRmKGJ1ZiwgYWxsb2Nfc2l6ZSwNCj4gKwkJCQkJCSAgICAi
JXNcdFwiJXNcIjogXCIlc1wiLFxuIiwNCj4gKwkJCQkJCSAgICBidWYsDQo+ICsNCj4gaHBfd21p
X2VsZW1lbnRzW3R5cGVdW2ldLCBzdHIpOw0KPiArCQl9DQo+ICsJCWtmcmVlKHN0cik7DQo+ICsJ
CXN0ciA9IE5VTEw7DQo+ICsNCj4gKwl9DQo+ICsNCj4gKwlmb3IgKGkgPSAzOyBpIDwgaHBfd21p
X2VsZW1lbnRzX2NvdW50W3R5cGVdOyBpKyspIHsNCj4gKwkJaWYgKHR5cGUgPT0gSFBXTUlfRU5V
TUVSQVRJT05fVFlQRSAmJiBpID09IDkpIHsNCj4gKwkJCXN0YXR1cyA9IGdldF9zdHJpbmdfZnJv
bV9idWZmZXIoKHUxNiAqKikmb2JqLQ0KPiA+YnVmZmVyLnBvaW50ZXIsICZzdHIpOw0KPiArCQkJ
aWYgKEFDUElfU1VDQ0VTUyhzdGF0dXMpKSB7DQo+ICsJCQkJLyoNCj4gKwkJCQkgKiBSZXBvcnQg
IkN1cnJlbnRWYWx1ZSIgYXMgIlZhbHVlIg0KPiArCQkJCSAqLw0KPiArCQkJCWJ1Zl9zaXplID0g
c25wcmludGYoYnVmLCBhbGxvY19zaXplLA0KPiArCQkJCQkJICAgICIlc1x0XCJWYWx1ZVwiOiBc
IiVzXCIsXG4iLA0KPiBidWYsIHN0cik7DQo+ICsJCQl9DQo+ICsJCQlrZnJlZShzdHIpOw0KPiAr
CQkJc3RyID0gTlVMTDsNCj4gKwkJCWNvbnRpbnVlOw0KPiArDQo+ICsJCX0gZWxzZSBpZiAodHlw
ZSA9PSBIUFdNSV9QQVNTV09SRF9UWVBFICYmIGkgPT0gMTIpIHsNCj4gKwkJCS8qDQo+ICsJCQkg
KiBSZXBvcnQgbGlzdCBvZiAiU3VwcG9ydEVuY29kaW5nIg0KPiArCQkJICoNCj4gKwkJCSAqCSJT
dXBwb3J0ZWRFbmNvZGluZyI6IFsNCj4gKwkJCSAqCQkidXRmLTE2Ig0KPiArCQkJICoJXSwNCj4g
KwkJCSAqDQo+ICsJCQkgKi8NCj4gKw0KPiArCQkJYnVmX3NpemUgPSBzbnByaW50ZihidWYsIGFs
bG9jX3NpemUsICIlc1x0XCIlc1wiOiBbXG4iLA0KPiArCQkJCQkgICAgYnVmLCBocF93bWlfZWxl
bWVudHNbdHlwZV1baV0pOw0KPiArCQkJZm9yIChqID0gMDsgaiA8IHNpemU7IGorKykgew0KPiAr
CQkJCXN0YXR1cyA9IGdldF9zdHJpbmdfZnJvbV9idWZmZXIoKHUxNg0KPiAqKikmb2JqLT5idWZm
ZXIucG9pbnRlciwgJnN0cik7DQo+ICsJCQkJaWYgKEFDUElfU1VDQ0VTUyhzdGF0dXMpKSB7DQo+
ICsJCQkJCWlmIChqID09IHNpemUgLSAxKQ0KPiArCQkJCQkJYnVmX3NpemUgPSBzbnByaW50Zihi
dWYsDQo+IGFsbG9jX3NpemUsDQo+ICsNCj4gIiVzXHRcdFwiJXNcIlxuIiwgYnVmLCBzdHIpOw0K
PiArCQkJCQllbHNlDQo+ICsJCQkJCQlidWZfc2l6ZSA9IHNucHJpbnRmKGJ1ZiwNCj4gYWxsb2Nf
c2l6ZSwNCj4gKw0KPiAiJXNcdFx0XCIlc1wiLFxuIiwgYnVmLCBzdHIpOw0KPiArCQkJCX0NCj4g
KwkJCQlrZnJlZShzdHIpOw0KPiArCQkJCXN0ciA9IE5VTEw7DQo+ICsJCQl9DQo+ICsJCQlidWZf
c2l6ZSA9IHNucHJpbnRmKGJ1ZiwgYWxsb2Nfc2l6ZSwgIiVzXHRdLFxuIiwgYnVmKTsNCj4gKwkJ
CWNvbnRpbnVlOw0KPiArCQl9DQo+ICsNCj4gKwkJc2l6ZSA9IDA7DQo+ICsJCXN0YXR1cyA9IGdl
dF9pbnRlZ2VyX2Zyb21fYnVmZmVyKChpbnQgKiopJm9iai0NCj4gPmJ1ZmZlci5wb2ludGVyLCAm
aW50ZWdlcik7DQo+ICsJCWlmIChBQ1BJX1NVQ0NFU1Moc3RhdHVzKSkgew0KPiArCQkJLyoNCj4g
KwkJCSAqIFJlcG9ydCAiUHJlcmVxdWlzaXRlU2l6ZSIgYW5kICJTaXplIiB2YWx1ZXMNCj4gKwkJ
CSAqCS4uLg0KPiArCQkJICoJIlByZXJlcXVpc2l0ZVNpemUiOiAxLA0KPiArCQkJICoJLi4uDQo+
ICsJCQkgKgkiU2l6ZSI6IDIsDQo+ICsJCQkgKgkuLi4NCj4gKwkJCSAqLw0KPiArCQkJaWYgKGkg
PT0gNykNCj4gKwkJCQlzaXplID0gaW50ZWdlcjsNCj4gKwkJCWVsc2UgaWYgKHR5cGUgPT0gSFBX
TUlfRU5VTUVSQVRJT05fVFlQRSAmJiBpDQo+ID09IDEwKQ0KPiArCQkJCXNpemUgPSBpbnRlZ2Vy
Ow0KPiArCQkJZWxzZSBpZiAodHlwZSA9PSBIUFdNSV9PUkRFUkVETElTVF9UWVBFICYmIGkgPT0N
Cj4gOSkNCj4gKwkJCQlzaXplID0gaW50ZWdlcjsNCj4gKwkJCWVsc2UgaWYgKHR5cGUgPT0gSFBX
TUlfUEFTU1dPUkRfVFlQRSAmJiBpID09DQo+IDExKQ0KPiArCQkJCXNpemUgPSBpbnRlZ2VyOw0K
PiArDQo+ICsJCQlidWZfc2l6ZSA9IHNucHJpbnRmKGJ1ZiwgYWxsb2Nfc2l6ZSwgIiVzXHRcIiVz
XCI6DQo+ICVkLFxuIiwgYnVmLA0KPiArCQkJCQkgICAgaHBfd21pX2VsZW1lbnRzW3R5cGVdW2ld
LA0KPiBpbnRlZ2VyKTsNCj4gKwkJfQ0KPiArDQo+ICsJCWlmIChzaXplID4gMjApDQo+ICsJCQlw
cl93YXJuKCIlcyBleGNlZWRlZCB0aGUgbWF4aW11bSBudW1iZXIgb2YNCj4gZWxlbWVudHMgc3Vw
cG9ydGVkIG9yIGRhdGEgbWF5IGJlIG1hbGZvcm1lZFxuIiwNCj4gKwkJCQlocF93bWlfZWxlbWVu
dHNbdHlwZV1baV0pOw0KPiArDQo+ICsJCWlmIChBQ1BJX1NVQ0NFU1Moc3RhdHVzKSAmJiBpID09
IDcpIHsNCj4gKwkJCWJ1Zl9zaXplID0gc25wcmludGYoYnVmLCBhbGxvY19zaXplLA0KPiAiJXNc
dFwiUHJlcmVxdWlzaXRlc1wiOiBbXG4iLCBidWYpOw0KPiArCQkJZm9yIChqID0gMDsgaiA8IHNp
emU7IGorKykgew0KPiArCQkJCXN0YXR1cyA9IGdldF9zdHJpbmdfZnJvbV9idWZmZXIoKHUxNg0K
PiAqKikmb2JqLT5idWZmZXIucG9pbnRlciwgJnN0cik7DQo+ICsJCQkJaWYgKEFDUElfU1VDQ0VT
UyhzdGF0dXMpKSB7DQo+ICsJCQkJCWJ1Zl9zaXplID0gc25wcmludGYoYnVmLCBhbGxvY19zaXpl
LA0KPiAiJXNcdFx0XCIlc1wiIiwgYnVmLCBzdHIpOw0KPiArDQo+ICsJCQkJCWlmIChqID09IHNp
emUgLSAxKQ0KPiArCQkJCQkJYnVmX3NpemUgPSBzbnByaW50ZihidWYsDQo+IGFsbG9jX3NpemUs
ICIlc1xuIiwgYnVmKTsNCj4gKwkJCQkJZWxzZQ0KPiArCQkJCQkJYnVmX3NpemUgPSBzbnByaW50
ZihidWYsDQo+IGFsbG9jX3NpemUsICIlcyxcbiIsIGJ1Zik7DQo+ICsNCj4gKwkJCQl9DQo+ICsJ
CQkJa2ZyZWUoc3RyKTsNCj4gKwkJCQlzdHIgPSBOVUxMOw0KPiArCQkJfQ0KPiArCQkJYnVmX3Np
emUgPSBzbnByaW50ZihidWYsIGFsbG9jX3NpemUsICIlc1x0XSxcbiIsIGJ1Zik7DQo+ICsJCX0N
Cj4gKwl9DQo+ICsNCj4gKwlpZiAodHlwZSA9PSBIUFdNSV9FTlVNRVJBVElPTl9UWVBFIHx8IHR5
cGUgPT0NCj4gSFBXTUlfT1JERVJFRExJU1RfVFlQRSkgew0KPiArCQlpZiAodHlwZSA9PSBIUFdN
SV9FTlVNRVJBVElPTl9UWVBFKQ0KPiArCQkJYnVmX3NpemUgPSBzbnByaW50ZihidWYsIGFsbG9j
X3NpemUsDQo+ICIlc1x0XCJQb3NzaWJsZVZhbHVlc1wiOiBbXG4iLCBidWYpOw0KPiArCQllbHNl
DQo+ICsJCQlidWZfc2l6ZSA9IHNucHJpbnRmKGJ1ZiwgYWxsb2Nfc2l6ZSwNCj4gIiVzXHRcIkVs
ZW1lbnRzXCI6IFtcbiIsIGJ1Zik7DQo+ICsNCj4gKwkJZm9yIChpID0gMDsgaSA8IHNpemU7IGkr
Kykgew0KPiArCQkJc3RhdHVzID0gZ2V0X3N0cmluZ19mcm9tX2J1ZmZlcigodTE2ICoqKSZvYmot
DQo+ID5idWZmZXIucG9pbnRlciwgJnN0cik7DQo+ICsJCQlpZiAoQUNQSV9TVUNDRVNTKHN0YXR1
cykpIHsNCj4gKwkJCQlidWZfc2l6ZSA9IHNucHJpbnRmKGJ1ZiwgYWxsb2Nfc2l6ZSwNCj4gIiVz
XHRcdFwiJXNcIiIsIGJ1Ziwgc3RyKTsNCj4gKw0KPiArCQkJCWlmIChpID09IHNpemUgLSAxKQ0K
PiArCQkJCQlidWZfc2l6ZSA9IHNucHJpbnRmKGJ1ZiwgYWxsb2Nfc2l6ZSwNCj4gIiVzXG4iLCBi
dWYpOw0KPiArCQkJCWVsc2UNCj4gKwkJCQkJYnVmX3NpemUgPSBzbnByaW50ZihidWYsIGFsbG9j
X3NpemUsDQo+ICIlcyxcbiIsIGJ1Zik7DQo+ICsNCj4gKwkJCX0NCj4gKwkJCWtmcmVlKHN0cik7
DQo+ICsJCQlzdHIgPSBOVUxMOw0KPiArCQl9DQo+ICsJCWJ1Zl9zaXplID0gc25wcmludGYoYnVm
LCBhbGxvY19zaXplLCAiJXNcdF0sXG4iLCBidWYpOw0KPiArCX0NCj4gKw0KPiArCS8qDQo+ICsJ
ICogcmVtb3ZlIHRyYWlsaW5nIGNvbW1hDQo+ICsJICovDQo+ICsJaWYgKGJ1Zl9zaXplID4gMykN
Cj4gKwkJYnVmW2J1Zl9zaXplIC0gMl0gPSAnICc7DQo+ICsNCj4gKwlyZXR1cm4gc25wcmludGYo
YnVmLCBhbGxvY19zaXplLCAiJXN9LFxuIiwgYnVmKTsNCj4gK30NCj4gKw0KPiArc3RhdGljIGlu
dCBocF9iaW9zX3NldHRpbmdzX2ZyZWVfYnVmZmVyKHZvaWQpDQo+ICt7DQo+ICsJbXV0ZXhfbG9j
aygmYnVmX211dGV4KTsNCj4gKwlrZnJlZShocF9iaW9zX3NldHRpbmdzX2J1ZmZlcik7DQo+ICsJ
c2V0dGluZ3NfYnVmZmVyX3NpemUgPSAwOw0KPiArCWJ1Zl9hbGxvY19zaXplID0gMDsNCj4gKwlt
dXRleF91bmxvY2soJmJ1Zl9tdXRleCk7DQo+ICsNCj4gKwlyZXR1cm4gMDsNCj4gK30NCj4gKw0K
PiArc3RhdGljIGludCBocF9iaW9zX3NldHRpbmdzX3JlYWxsb2NfYnVmZmVyKGNoYXIgKipidWYs
IGludCAqYnVmX3NpemUsDQo+ICsJCQkJCSAgIGludCAqYWxsb2Nfc2l6ZSwNCj4gKwkJCQkJICAg
c3RydWN0IG11dGV4ICpidWZfbXV0ZXgpDQo+ICt7DQo+ICsJaW50IG5ld19idWZmZXJfc2l6ZTsN
Cj4gKwljaGFyICpuZXdfYnVmID0gTlVMTDsNCj4gKwlpbnQgcmV0ID0gMDsNCj4gKw0KPiArCWlm
ICgqYnVmX3NpemUgKyBQQUdFX1NJWkUgPj0gKmFsbG9jX3NpemUpIHsNCj4gKwkJbmV3X2J1ZmZl
cl9zaXplID0gYnVmX2FsbG9jX3NpemUgKyAyICogUEFHRV9TSVpFOw0KPiArDQo+ICsJCW11dGV4
X2xvY2soYnVmX211dGV4KTsNCj4gKwkJbmV3X2J1ZiA9IGtyZWFsbG9jKCpidWYsIG5ld19idWZm
ZXJfc2l6ZSwgR0ZQX0tFUk5FTCk7DQo+ICsJCW11dGV4X3VubG9jayhidWZfbXV0ZXgpOw0KPiAr
CQlpZiAobmV3X2J1Zikgew0KPiArCQkJbXV0ZXhfbG9jayhidWZfbXV0ZXgpOw0KPiArCQkJKmJ1
ZiA9IG5ld19idWY7DQo+ICsJCQkqYWxsb2Nfc2l6ZSA9IGtzaXplKG5ld19idWYpOw0KPiArCQkJ
bXV0ZXhfdW5sb2NrKGJ1Zl9tdXRleCk7DQo+ICsJCX0gZWxzZSB7DQo+ICsJCQlocF9iaW9zX3Nl
dHRpbmdzX2ZyZWVfYnVmZmVyKCk7DQo+ICsJCQlyZXQgPSAtRU5PTUVNOw0KPiArCQl9DQo+ICsJ
fQ0KPiArDQo+ICsJcmV0dXJuIHJldDsNCj4gK30NCj4gKw0KPiArc3RhdGljIGludCBhcHBlbmRf
c2V0dGluZ3NfdG9fYnVmZmVyKGNoYXIgKmd1aWQsIGludCB0eXBlLCBjaGFyICoqYnVmLA0KPiAr
CQkJCSAgICAgaW50ICpidWZfc2l6ZSwgaW50ICphbGxvY19zaXplLA0KPiArCQkJCSAgICAgc3Ry
dWN0IG11dGV4ICpidWZfbXV0ZXgpDQo+ICt7DQo+ICsJdW5pb24gYWNwaV9vYmplY3QgKm9iaiA9
IE5VTEw7DQo+ICsJaW50IHJldCA9IDA7DQo+ICsJaW50IHN0YXR1cyA9IDA7DQo+ICsJaW50IGlu
c3RhbmNlID0gMDsNCj4gKw0KPiArCS8qDQo+ICsJICogUXVlcnkgYWxsIHRoZSBpbnN0YW5jZXMg
dW50aWwgdG8gcmVjZWl2ZSBhIEFFX0JBRF9QQVJBTUVURVINCj4gKwkgKi8NCj4gKwlkbyB7DQo+
ICsJCXJldCA9IGhwX3dtaV9nZXRfc2V0dGluZ19vYmplY3QoZ3VpZCwgaW5zdGFuY2UrKywgJm9i
aik7DQo+ICsJCWlmIChBQ1BJX1NVQ0NFU1MocmV0KSAmJiBvYmogIT0gTlVMTCkgew0KPiArCQkJ
c3RhdHVzID0gMDsNCj4gKwkJCWlmIChvYmotPnR5cGUgPT0gQUNQSV9UWVBFX1BBQ0tBR0UpIHsN
Cj4gKwkJCQltdXRleF9sb2NrKGJ1Zl9tdXRleCk7DQo+ICsJCQkJc3RhdHVzID0NCj4gYXBwZW5k
X3BhY2thZ2VfZWxlbWVudHNfdG9fYnVmZmVyKG9iaiwNCj4gKwkJCQkJCQkqYnVmLCAqYWxsb2Nf
c2l6ZSwNCj4gdHlwZSk7DQo+ICsJCQkJaWYgKHN0YXR1cyA+IDApDQo+ICsJCQkJCSpidWZfc2l6
ZSA9IHN0YXR1czsNCj4gKwkJCQltdXRleF91bmxvY2soYnVmX211dGV4KTsNCj4gKw0KPiArCQkJ
fSBlbHNlIGlmIChvYmotPnR5cGUgPT0gQUNQSV9UWVBFX0JVRkZFUikgew0KPiArCQkJCW11dGV4
X2xvY2soYnVmX211dGV4KTsNCj4gKwkJCQlzdGF0dXMgPQ0KPiBhcHBlbmRfYnVmZmVyX2VsZW1l
bnRzX3RvX2J1ZmZlcihvYmosDQo+ICsJCQkJCQkJKmJ1ZiwgKmFsbG9jX3NpemUsDQo+IHR5cGUp
Ow0KPiArCQkJCWlmIChzdGF0dXMgPiAwKQ0KPiArCQkJCQkqYnVmX3NpemUgPSBzdGF0dXM7DQo+
ICsJCQkJbXV0ZXhfdW5sb2NrKGJ1Zl9tdXRleCk7DQo+ICsNCj4gKwkJCX0gZWxzZQ0KPiArCQkJ
CXByX3dhcm4oIlRoZSByZXRyaWV2ZWQgb2JqZWN0IHR5cGUoJWQpIGlzDQo+IG5vdCBzdXBwb3J0
ZWQgeWV0XG4iLA0KPiArCQkJCQlvYmotPnR5cGUpOw0KPiArDQo+ICsJCQlyZXQgPSBocF9iaW9z
X3NldHRpbmdzX3JlYWxsb2NfYnVmZmVyKGJ1ZiwgYnVmX3NpemUsDQo+IGFsbG9jX3NpemUsIGJ1
Zl9tdXRleCk7DQo+ICsJCX0NCj4gKw0KPiArCQlrZnJlZShvYmopOw0KPiArCQlvYmogPSBOVUxM
Ow0KPiArDQo+ICsJfSB3aGlsZSAoQUNQSV9TVUNDRVNTKHJldCkpOw0KPiArDQo+ICsJLyoNCj4g
KwkgKiBBRV9CQURfUEFSQU1FVEVSIG1lYW5zIHRoZSBsb29wIGVuZGVkIGJ5IGV4aGF1c3Rpb24N
Cj4gKwkgKi8NCj4gKwlpZiAocmV0ID09IEFFX0JBRF9QQVJBTUVURVIpDQo+ICsJCXJldCA9IDA7
DQo+ICsNCj4gKwlyZXR1cm4gcmV0Ow0KPiArfQ0KPiArDQo+ICtzdGF0aWMgaW50IGhwX2Jpb3Nf
c2V0dGluZ3NfZmlsbF9idWZmZXIodm9pZCkNCj4gK3sNCj4gKwlpbnQgc3RhdHVzID0gMDsNCj4g
KwlpbnQgaW5pdGlhbF9idWZmZXJfc2l6ZSA9IDIwICogUEFHRV9TSVpFOw0KPiArDQo+ICsJbXV0
ZXhfbG9jaygmYnVmX211dGV4KTsNCj4gKwlocF9iaW9zX3NldHRpbmdzX2J1ZmZlciA9IGttYWxs
b2MoaW5pdGlhbF9idWZmZXJfc2l6ZSwgR0ZQX0tFUk5FTCk7DQo+ICsJbXV0ZXhfdW5sb2NrKCZi
dWZfbXV0ZXgpOw0KPiArCWlmICghaHBfYmlvc19zZXR0aW5nc19idWZmZXIpDQo+ICsJCXJldHVy
biAtRU5PTUVNOw0KPiArDQo+ICsJbXV0ZXhfbG9jaygmYnVmX211dGV4KTsNCj4gKwlidWZfYWxs
b2Nfc2l6ZSA9IGtzaXplKGhwX2Jpb3Nfc2V0dGluZ3NfYnVmZmVyKTsNCj4gKwlzZXR0aW5nc19i
dWZmZXJfc2l6ZSA9IHNucHJpbnRmKGhwX2Jpb3Nfc2V0dGluZ3NfYnVmZmVyLA0KPiArCQkJCQli
dWZfYWxsb2Nfc2l6ZSwgIltcbiIpOw0KPiArCW11dGV4X3VubG9jaygmYnVmX211dGV4KTsNCj4g
Kw0KPiArCXN0YXR1cyA9IGFwcGVuZF9zZXR0aW5nc190b19idWZmZXIoSFBXTUlfU1RSSU5HX0dV
SUQsDQo+ICsJCUhQV01JX1NUUklOR19UWVBFLCAmaHBfYmlvc19zZXR0aW5nc19idWZmZXIsDQo+
ICsJCSZzZXR0aW5nc19idWZmZXJfc2l6ZSwgJmJ1Zl9hbGxvY19zaXplLCAmYnVmX211dGV4KTsN
Cj4gKwlpZiAoQUNQSV9GQUlMVVJFKHN0YXR1cykpDQo+ICsJCXByX2VycigiZXJyb3IgMHgleCBv
Y2N1cnJlZCByZXRyaWV2aW5nIHN0cmluZyBpbnN0YW5jZXNcbiIsDQo+IHN0YXR1cyk7DQo+ICsN
Cj4gKwlzdGF0dXMgPSBhcHBlbmRfc2V0dGluZ3NfdG9fYnVmZmVyKEhQV01JX0lOVEVHRVJfR1VJ
RCwNCj4gKwkJSFBXTUlfSU5URUdFUl9UWVBFLCAmaHBfYmlvc19zZXR0aW5nc19idWZmZXIsDQo+
ICsJCSZzZXR0aW5nc19idWZmZXJfc2l6ZSwgJmJ1Zl9hbGxvY19zaXplLCAmYnVmX211dGV4KTsN
Cj4gKwlpZiAoQUNQSV9GQUlMVVJFKHN0YXR1cykpDQo+ICsJCXByX2VycigiZXJyb3IgMHgleCBv
Y2N1cnJlZCByZXRyaWV2aW5nIGludGVnZXIgaW5zdGFuY2VzXG4iLA0KPiBzdGF0dXMpOw0KPiAr
DQo+ICsJc3RhdHVzID0gYXBwZW5kX3NldHRpbmdzX3RvX2J1ZmZlcihIUFdNSV9FTlVNRVJBVElP
Tl9HVUlELA0KPiArCQlIUFdNSV9FTlVNRVJBVElPTl9UWVBFLCAmaHBfYmlvc19zZXR0aW5nc19i
dWZmZXIsDQo+ICsJCSZzZXR0aW5nc19idWZmZXJfc2l6ZSwgJmJ1Zl9hbGxvY19zaXplLCAmYnVm
X211dGV4KTsNCj4gKwlpZiAoQUNQSV9GQUlMVVJFKHN0YXR1cykpDQo+ICsJCXByX2VycigiZXJy
b3IgMHgleCBvY2N1cnJlZCByZXRyaWV2aW5nIGVudW1lcmF0aW9uDQo+IGluc3RhbmNlc1xuIiwg
c3RhdHVzKTsNCj4gKw0KPiArCXN0YXR1cyA9IGFwcGVuZF9zZXR0aW5nc190b19idWZmZXIoSFBX
TUlfT1JERVJFRExJU1RfR1VJRCwNCj4gKwkJSFBXTUlfT1JERVJFRExJU1RfVFlQRSwgJmhwX2Jp
b3Nfc2V0dGluZ3NfYnVmZmVyLA0KPiArCQkmc2V0dGluZ3NfYnVmZmVyX3NpemUsICZidWZfYWxs
b2Nfc2l6ZSwgJmJ1Zl9tdXRleCk7DQo+ICsJaWYgKEFDUElfRkFJTFVSRShzdGF0dXMpKQ0KPiAr
CQlwcl9lcnIoImVycm9yIDB4JXggb2NjdXJyZWQgcmV0cmlldmluZyBvcmRlcmVkIGxpc3QNCj4g
aW5zdGFuY2VzXG4iLCBzdGF0dXMpOw0KPiArDQo+ICsJc3RhdHVzID0gYXBwZW5kX3NldHRpbmdz
X3RvX2J1ZmZlcihIUFdNSV9QQVNTV09SRF9HVUlELA0KPiArCQlIUFdNSV9QQVNTV09SRF9UWVBF
LCAmaHBfYmlvc19zZXR0aW5nc19idWZmZXIsDQo+ICsJCSZzZXR0aW5nc19idWZmZXJfc2l6ZSwg
JmJ1Zl9hbGxvY19zaXplLCAmYnVmX211dGV4KTsNCj4gKwlpZiAoQUNQSV9GQUlMVVJFKHN0YXR1
cykpDQo+ICsJCXByX2VycigiZXJyb3IgMHgleCBvY2N1cnJlZCByZXRyaWV2aW5nIHBhc3N3b3Jk
IGxpc3QNCj4gaW5zdGFuY2VzXG4iLCBzdGF0dXMpOw0KPiArDQo+ICsJbXV0ZXhfbG9jaygmYnVm
X211dGV4KTsNCj4gKwkvKg0KPiArCSAqIHJlbW92ZSB0cmFpbGluZyBjb21tYQ0KPiArCSAqLw0K
PiArCWlmIChzZXR0aW5nc19idWZmZXJfc2l6ZSA+PSAzKSB7DQo+ICsJCWlmIChocF9iaW9zX3Nl
dHRpbmdzX2J1ZmZlcltzZXR0aW5nc19idWZmZXJfc2l6ZSAtIDJdID09ICcsJykNCj4gKwkJCWhw
X2Jpb3Nfc2V0dGluZ3NfYnVmZmVyW3NldHRpbmdzX2J1ZmZlcl9zaXplIC0gMl0gPSAnDQo+ICc7
DQo+ICsJfQ0KPiArCXNldHRpbmdzX2J1ZmZlcl9zaXplID0gc25wcmludGYoaHBfYmlvc19zZXR0
aW5nc19idWZmZXIsDQo+ICsJCQkJCWJ1Zl9hbGxvY19zaXplLCAiJXNdXG4iLA0KPiArCQkJCQlo
cF9iaW9zX3NldHRpbmdzX2J1ZmZlcik7DQo+ICsJbXV0ZXhfdW5sb2NrKCZidWZfbXV0ZXgpOw0K
PiArDQo+ICsJcmV0dXJuIHNldHRpbmdzX2J1ZmZlcl9zaXplOw0KPiArfQ0KPiArDQo+ICsvKg0K
PiArICogc3VyZV9hZG1pbl9zZXR0aW5nc19yZWFkIC0gUmV0dXJuIGEgZm9ybWF0dGVkIGZpbGUg
d2l0aCBzZXR0aW5ncw0KPiArICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmQgcG9z
c2libGUgb3B0aW9ucyByZWFkIGZyb20gQklPUw0KPiArICoNCj4gKyAqIEBmaWxwOiAgUG9pbnRl
ciB0byBmaWxlIG9mIHNldHRpbmdzIHJlYWQgZnJvbSBCSU9TDQo+ICsgKiBAa29iajogIFBvaW50
ZXIgdG8gYSBrZXJuZWwgb2JqZWN0IG9mIHRoaW5ncyB0aGF0IHNob3cgdXAgYXMgZGlyZWN0b3J5
IGluDQo+IHRoZSBzeXNmcyBmaWxlc3lzdGVtLg0KPiArICogQGF0dHI6ICBQb2ludGVyIHRvIGxp
c3Qgb2YgcmVhZCBhdHRyaWJ1dGVzDQo+ICsgKiBAYnVmOiAgIFBvaW50ZXIgdG8gYnVmZmVyDQo+
ICsgKiBAb2ZmOiAgIEZpbGUgY3VycmVudCBvZmZzZXQNCj4gKyAqIEBjb3VudDogQnVmZmVyIHNp
emUNCj4gKyAqDQo+ICsgKiBSZXR1cm5zIHRoZSBjb3VudCBvZiB1bmljb2RlIGNoYXJzIHJlYWQg
aWYgc3VjY2Vzc2Z1bCwgb3RoZXJ3aXNlDQo+ICsgKgkJLUVOT01FTSB1bmFibGUgdG8gYWxsb2Nh
dGUgbWVtb3J5DQo+ICsgKgkJLUVJTlZBTCBidWZmZXIgbm90IGFsbG9jYXRlZCBvciB0b28gc21h
bGwNCj4gKyAqDQo+ICsgKi8NCj4gK3N0YXRpYyBzc2l6ZV90IHN1cmVfYWRtaW5fc2V0dGluZ3Nf
cmVhZChzdHJ1Y3QgZmlsZSAqZmlscCwgc3RydWN0IGtvYmplY3QNCj4gKmtvYmosDQo+ICsJCQkJ
CXN0cnVjdCBiaW5fYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYsDQo+IGxvZmZfdCBvZmYsIHNp
emVfdCBjb3VudCkNCj4gK3sNCj4gKwlzc2l6ZV90IHJldDsNCj4gKw0KPiArCS8qIGNsZWFyIHRo
ZSBidWZmZXIgd2hlbiBvZmZzZXQgaXMgcG9pbnRpbmcgdG8gdGhlIGxhc3QgcG9zaXRpb24gKi8N
Cj4gKwlpZiAob2ZmID49IHNldHRpbmdzX2J1ZmZlcl9zaXplICYmIHNldHRpbmdzX2J1ZmZlcl9z
aXplID4gMCkgew0KPiArCQlocF9iaW9zX3NldHRpbmdzX2ZyZWVfYnVmZmVyKCk7DQo+ICsJCXJl
dHVybiAwOw0KPiArCX0NCj4gKw0KPiArCS8qIGNsZWFyIHRoZSBidWZmZXIgd2hlbmV2ZXIgdGhl
IHJlYWQgc3RhcnRzIGZyb20gdGhlIGZpcnN0IHBvc2l0aW9uDQo+ICovDQo+ICsJaWYgKG9mZiA9
PSAwICYmIHNldHRpbmdzX2J1ZmZlcl9zaXplID4gMCkNCj4gKwkJaHBfYmlvc19zZXR0aW5nc19m
cmVlX2J1ZmZlcigpOw0KPiArDQo+ICsJaWYgKHNldHRpbmdzX2J1ZmZlcl9zaXplID09IDApDQo+
ICsJCWhwX2Jpb3Nfc2V0dGluZ3NfZmlsbF9idWZmZXIoKTsNCj4gKw0KPiArCW11dGV4X2xvY2so
JmJ1Zl9tdXRleCk7DQo+ICsJcmV0ID0gbWVtb3J5X3JlYWRfZnJvbV9idWZmZXIoYnVmLCBjb3Vu
dCwgJm9mZiwNCj4gaHBfYmlvc19zZXR0aW5nc19idWZmZXIsDQo+ICsJCQkJICAgICAgc2V0dGlu
Z3NfYnVmZmVyX3NpemUpOw0KPiArCW11dGV4X3VubG9jaygmYnVmX211dGV4KTsNCj4gKw0KPiAr
CXJldHVybiByZXQ7DQo+ICt9DQo+ICsNCj4gKw0KPiArLyoNCj4gKyAqIGFzY2lpX3RvX3V0ZjE2
X3VuaWNvZGUgLSAgQ29udmVydCBhc2NpaSBzdHJpbmcgdG8gVVRGLTE2IHVuaWNvZGUNCj4gKyAq
DQo+ICsgKiBAcDogICBVbmljb2RlIGJ1ZmZlciBhZGRyZXNzDQo+ICsgKiBAc3RyOiBzdHJpbmcg
dG8gY29udmVydCB0byB1bmljb2RlDQo+ICsgKg0KPiArICogUmV0dXJucyBhIHZvaWQgcG9pbnRl
ciB0byB0aGUgYnVmZmVyIGNvbnRhaW5pbmcgdW5pY29kZSBzdHJpbmcNCj4gKyAqLw0KPiArc3Rh
dGljIHZvaWQgKmFzY2lpX3RvX3V0ZjE2X3VuaWNvZGUodTE2ICpwLCBjb25zdCB1OCAqc3RyKQ0K
PiArew0KPiArCWludCBsZW4gPSBzdHJsZW4oc3RyKTsNCj4gKw0KPiArCS8qDQo+ICsJICogQWRk
IG51bGwgY2hhcmFjdGVyIHdoZW4gcmVhZGluZyBhbiBlbXB0eSBzdHJpbmcNCj4gKwkgKi8NCj4g
KwlpZiAobGVuID09IDApIHsNCj4gKwkJKnArKyA9IDI7DQo+ICsJCSpwKysgPSAodTgpMHgwMDsN
Cj4gKwkJcmV0dXJuIHA7DQo+ICsJfQ0KPiArCSpwKysgPSBsZW4gKiAyOw0KPiArCXV0ZjhzX3Rv
X3V0ZjE2cyhzdHIsIHN0cmxlbihzdHIpLCBVVEYxNl9IT1NUX0VORElBTiwgcCwgbGVuKTsNCj4g
KwlwICs9IGxlbjsNCj4gKw0KPiArCXJldHVybiBwOw0KPiArfQ0KPiArDQo+ICsvKg0KPiArICog
aHBfd21pX3NldF9iaW9zX3NldHRpbmcgLSBTZXQgc2V0dGluZydzIHZhbHVlIGluIEJJT1MNCj4g
KyAqDQo+ICsgKiBAaW5wdXRfYnVmZmVyOiBJbnB1dCBidWZmZXIgYWRkcmVzcw0KPiArICogQGlu
cHV0X3NpemU6ICAgSW5wdXQgYnVmZmVyIHNpemUNCj4gKyAqDQo+ICsgKiBSZXR1cm5zOiBDb3Vu
dCBvZiB1bmljb2RlIGNoYXJhY3RlcnMgd3JpdHRlbiB0byBCSU9TIGlmIHN1Y2Nlc3NmdWwsDQo+
IG90aGVyd2lzZQ0KPiArICoJCS1FTk9NRU0gdW5hYmxlIHRvIGFsbG9jYXRlIG1lbW9yeQ0KPiAr
ICoJCS1FSU5WQUwgYnVmZmVyIG5vdCBhbGxvY2F0ZWQgb3IgdG9vIHNtYWxsDQo+ICsgKi8NCj4g
K3N0YXRpYyBpbnQgaHBfd21pX3NldF9iaW9zX3NldHRpbmcodTE2ICppbnB1dF9idWZmZXIsIHUz
MiBpbnB1dF9zaXplKQ0KPiArew0KPiArCXVuaW9uIGFjcGlfb2JqZWN0ICpvYmo7DQo+ICsJc3Ry
dWN0IGFjcGlfYnVmZmVyIGlucHV0ID0ge2lucHV0X3NpemUsIGlucHV0X2J1ZmZlcn07DQo+ICsJ
c3RydWN0IGFjcGlfYnVmZmVyIG91dHB1dCA9IHtBQ1BJX0FMTE9DQVRFX0JVRkZFUiwgTlVMTH07
DQo+ICsJaW50IHJldCA9IDA7DQo+ICsNCj4gKwlyZXQgPSB3bWlfZXZhbHVhdGVfbWV0aG9kKEhQ
V01JX1NFVEJJT1NTRVRUSU5HX0dVSUQsIDAsIDEsDQo+ICZpbnB1dCwgJm91dHB1dCk7DQo+ICsN
Cj4gKwlvYmogPSBvdXRwdXQucG9pbnRlcjsNCj4gKwlpZiAoIW9iaikNCj4gKwkJcmV0dXJuIC1F
SU5WQUw7DQo+ICsNCj4gKwlpZiAob2JqLT50eXBlICE9IEFDUElfVFlQRV9JTlRFR0VSKQ0KPiAr
CQlyZXQgPSAtRUlOVkFMOw0KPiArDQo+ICsJcmV0ID0gb2JqLT5pbnRlZ2VyLnZhbHVlOw0KPiAr
CWtmcmVlKG9iaik7DQo+ICsJcmV0dXJuIHJldDsNCj4gK30NCj4gKw0KPiArLyogU3VyZSBBZG1p
biBGdW5jdGlvbnMgKi8NCj4gKw0KPiArI2RlZmluZSBVVEZfUFJFRklYCQkJKCh1bnNpZ25lZCBj
aGFyICopIjx1dGYtMTYvPiIpDQo+ICsjZGVmaW5lIEJFQU1fUFJFRklYCQkJKCh1bnNpZ25lZCBj
aGFyDQo+ICopIjxCRUFNLz4iKQ0KPiArDQo+ICsvKg0KPiArICogc3VyZV9hZG1pbl9zZXR0aW5n
c193cml0ZSAtIFdyaXRlIHRoZSBjb250ZW50cyBvZiBhIGZvcm1hdHRlZCBmaWxlDQo+ICsgKiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aXRoIHNldHRpbmdzIGFuZCBwZXJmb3JtcyB0
aGUgbG9naWMNCj4gKyAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIGNoYW5nZSBh
bnkgc2V0dGluZ3MgaW4gQklPUy4NCj4gKyAqDQo+ICsgKiBAZmlscDogIFBvaW50ZXIgdG8gZmls
ZSBvZiBzZXR0aW5ncyB0byBiZSB3cml0dGVuIHRvIEJJT1MNCj4gKyAqIEBrb2JqOiAgUG9pbnRl
ciB0byBhIGtlcm5lbCBvYmplY3Qgb2YgdGhpbmdzIHRoYXQgc2hvdyB1cCBhcyBkaXJlY3Rvcnkg
aW4NCj4gdGhlIHN5c2ZzIGZpbGVzeXN0ZW0uDQo+ICsgKiBAYXR0cjogIFBvaW50ZXIgdG8gbGlz
dCBvZiBhdHRyaWJ1dGVzIGZvciB0aGUgd3JpdGUgb3BlcmF0aW9uDQo+ICsgKiBAYnVmOiAgIFBv
aW50ZXIgdG8gYnVmZmVyDQo+ICsgKiBAb2ZmOiAgIEZpbGUgY3VycmVudCBvZmZzZXQNCj4gKyAq
IEBjb3VudDogQnVmZmVyIHNpemUNCj4gKyAqDQo+ICsgKg0KPiArICogUmV0dXJucyB0aGUgY291
bnQgb2YgdW5pY29kZSBjaGFyYWN0ZXJzIHdyaXR0ZW4gdG8gQklPUyBpZiBzdWNjZXNzZnVsLA0K
PiBvdGhlcndpc2UNCj4gKyAqCQktRU5PTUVNIHVuYWJsZSB0byBhbGxvY2F0ZSBtZW1vcnkNCj4g
KyAqCQktRUlOVkFMIGJ1ZmZlciBub3QgYWxsb2NhdGVkIG9yIHRvbyBzbWFsbA0KPiArICoNCj4g
KyAqLw0KPiArc3RhdGljIHNzaXplX3Qgc3VyZV9hZG1pbl9zZXR0aW5nc193cml0ZShzdHJ1Y3Qg
ZmlsZSAqZmlscCwgc3RydWN0IGtvYmplY3QNCj4gKmtvYmosDQo+ICsJCQlzdHJ1Y3QgYmluX2F0
dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmLCBsb2ZmX3Qgb2ZmLCBzaXplX3QNCj4gY291bnQpDQo+
ICt7DQo+ICsJaW50IHN0YXR1cyA9IDA7DQo+ICsJY2hhciAqcGFydCA9IE5VTEw7DQo+ICsJaW50
IHBhcnRfbGVuID0gMDsNCj4gKwl1bnNpZ25lZCBzaG9ydCAqYnVmZmVyID0gTlVMTDsNCj4gKwl1
bnNpZ25lZCBzaG9ydCAqdG1wc3RyID0gTlVMTDsNCj4gKwlpbnQgYnVmZmVyX3NpemUgPSAoY291
bnQgKyBzdHJsZW4oVVRGX1BSRUZJWCkpICogc2l6ZW9mKHVuc2lnbmVkDQo+IHNob3J0KTsNCj4g
Kw0KPiArCWJ1ZmZlciA9IGttYWxsb2MoYnVmZmVyX3NpemUsIEdGUF9LRVJORUwpOw0KPiArCWlm
ICghYnVmZmVyKQ0KPiArCQlyZXR1cm4gLUVOT01FTTsNCj4gKw0KPiArCXRtcHN0ciA9IGJ1ZmZl
cjsNCj4gKwlwYXJ0ID0gc3Ryc2VwKCZidWYsICIsIik7DQo+ICsJaWYgKCFwYXJ0KSB7DQo+ICsJ
CXN0YXR1cyA9IC1FSU5WQUw7DQo+ICsJCWdvdG8gb3V0X2ZyZWU7DQo+ICsJfQ0KPiArCXRtcHN0
ciA9IGFzY2lpX3RvX3V0ZjE2X3VuaWNvZGUodG1wc3RyLCBwYXJ0KTsNCj4gKwlwYXJ0ID0gc3Ry
c2VwKCZidWYsICIsIik7DQo+ICsJaWYgKCFwYXJ0KSB7DQo+ICsJCXN0YXR1cyA9IC1FSU5WQUw7
DQo+ICsJCWdvdG8gb3V0X2ZyZWU7DQo+ICsJfQ0KPiArDQo+ICsJLyogQWRkIGV4dHJhIGJ1ZmZl
ciBzcGFjZSB3aGVuIGVuY291bnRlcmluZyBhbiBlbXB0eSBzdHJpbmcgKi8NCj4gKwlpZiAoIXN0
cmxlbihwYXJ0KSkNCj4gKwkJYnVmZmVyX3NpemUgKz0gc2l6ZW9mKHVuc2lnbmVkIHNob3J0KTsN
Cj4gKwl0bXBzdHIgPSBhc2NpaV90b191dGYxNl91bmljb2RlKHRtcHN0ciwgcGFydCk7DQo+ICsJ
cGFydCA9IHN0cnNlcCgmYnVmLCAiLCIpOw0KPiArCWlmICghcGFydCkgew0KPiArCQlzdGF0dXMg
PSAtRUlOVkFMOw0KPiArCQlnb3RvIG91dF9mcmVlOw0KPiArCX0NCj4gKwlwYXJ0X2xlbiA9IHN0
cmxlbihwYXJ0KSAtIDE7DQo+ICsJcGFydFtwYXJ0X2xlbl0gPSAnXDAnOw0KPiArDQo+ICsJaWYg
KHN0cm5jbXAocGFydCwgQkVBTV9QUkVGSVgsIHN0cmxlbihCRUFNX1BSRUZJWCkpID09IDApIHsN
Cj4gKwkgICAgICAgLyoNCj4gKwkJKiBCRUFNX1BSRUZJWCBpcyBhcHBlbmQgdG8gYnVmZmVyIHdo
ZW4gYSBzaWduYXR1cmUNCj4gKwkJKiBpcyBwcm92aWRlZCBhbmQgU3VyZSBBZG1pbiBpcyBlbmFi
bGVkIGluIEJJT1MNCj4gKwkJKi8NCj4gKwkJLy8gQkVBTV9QUkVGSVggZm91bmQsIGNvbnZlcnQg
cGFydCB0byB1bmljb2RlDQo+ICsJCXRtcHN0ciA9IGFzY2lpX3RvX3V0ZjE2X3VuaWNvZGUodG1w
c3RyLCBwYXJ0KTsNCj4gKwkJLy8gZGVjcmVhc2UgYnVmZmVyIHNpemUgYWxsb2NhdGVkIGluaXRp
YWxseSBmb3IgVVRGX1BSRUZJWA0KPiArCQlidWZmZXJfc2l6ZSAtPSBzdHJsZW4oVVRGX1BSRUZJ
WCkgKiBzaXplb2YodW5zaWduZWQgc2hvcnQpOw0KPiArCX0gZWxzZSB7DQo+ICsJCS8qDQo+ICsJ
CSAqIFVURi0xNiBwcmVmaXggaXMgYXBwZW5kIHRvIHRoZSAqIGJ1ZmZlciB3aGVuIGEgQklPUw0K
PiArCQkgKiBhZG1pbiBwYXNzd29yZCBpcyBjb25maWd1cmVkIGluIEJJT1MNCj4gKwkJICovDQo+
ICsNCj4gKwkJLy8gYXBwZW5kIFVURl9QUkVGSVggdG8gcGFydCBhbmQgdGhlbiBjb252ZXJ0IGl0
IHRvIHVuaWNvZGUNCj4gKwkJcGFydCA9IGthc3ByaW50ZihHRlBfS0VSTkVMLCAiJXMlcyIsIFVU
Rl9QUkVGSVgsIHBhcnQpOw0KPiArCQlpZiAoIXBhcnQpDQo+ICsJCQlnb3RvIG91dF9mcmVlOw0K
PiArDQo+ICsJCXRtcHN0ciA9IGFzY2lpX3RvX3V0ZjE2X3VuaWNvZGUodG1wc3RyLCBwYXJ0KTsN
Cj4gKwkJa2ZyZWUocGFydCk7DQo+ICsJfQ0KPiArDQo+ICsJcGFydCA9IHN0cnNlcCgmYnVmLCAi
LCIpOw0KPiArCWlmIChwYXJ0KSB7DQo+ICsJCXN0YXR1cyA9IC1FSU5WQUw7DQo+ICsJCWdvdG8g
b3V0X2ZyZWU7DQo+ICsJfQ0KPiArCXN0YXR1cyA9IGhwX3dtaV9zZXRfYmlvc19zZXR0aW5nKGJ1
ZmZlciwgYnVmZmVyX3NpemUpOw0KPiArCWlmIChBQ1BJX0ZBSUxVUkUoc3RhdHVzKSkNCj4gKwkJ
c3RhdHVzID0gLUVJTlZBTDsNCj4gKw0KPiArb3V0X2ZyZWU6DQo+ICsJa2ZyZWUoYnVmZmVyKTsN
Cj4gKwlpZiAoQUNQSV9TVUNDRVNTKHN0YXR1cykpDQo+ICsJCXJldHVybiBjb3VudDsNCj4gKwly
ZXR1cm4gc3RhdHVzOw0KPiArfQ0KPiArDQo+ICtIUFdNSV9CSU5BVFRSX1JXKHN1cmVfYWRtaW4s
IHNldHRpbmdzLCAwKTsNCj4gKw0KPiArc3RhdGljIHN0cnVjdCBiaW5fYXR0cmlidXRlICpzdXJl
X2FkbWluX2JpbmF0dHJzW10gPSB7DQo+ICsJJnN1cmVfYWRtaW5fc2V0dGluZ3MsDQo+ICsJTlVM
TCwNCj4gK307DQo+ICsNCj4gK3N0YXRpYyBjb25zdCBzdHJ1Y3QgYXR0cmlidXRlX2dyb3VwIHN1
cmVfYWRtaW5fZ3JvdXAgPSB7DQo+ICsJLm5hbWUgPSAic3VyZV9hZG1pbiIsDQo+ICsJLmJpbl9h
dHRycyA9IHN1cmVfYWRtaW5fYmluYXR0cnMsDQo+ICt9Ow0KPiArDQo+ICBzdGF0aWMgREVWSUNF
X0FUVFJfUk8oZGlzcGxheSk7DQo+ICBzdGF0aWMgREVWSUNFX0FUVFJfUk8oaGRkdGVtcCk7DQo+
ICBzdGF0aWMgREVWSUNFX0FUVFJfUlcoYWxzKTsNCj4gQEAgLTEwNTAsNiArMjAyNiw3IEBAIHN0
YXRpYyBjb25zdCBzdHJ1Y3QgYXR0cmlidXRlX2dyb3VwDQo+ICpocF93bWlfZ3JvdXBzW10gPSB7
DQo+ICAJJmhwX3dtaV9ncm91cCwNCj4gIAkmc3BtX2dyb3VwLA0KPiAgCSZzdXJlX3N0YXJ0X2dy
b3VwLA0KPiArCSZzdXJlX2FkbWluX2dyb3VwLA0KPiAgCU5VTEwsDQo+ICB9Ow0KPiANCj4gLS0N
Cj4gMi4yNS4xDQo=
